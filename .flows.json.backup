[{"id":"d47f9ae6.2bf798","type":"tab","label":"Dashboard","disabled":false,"info":""},{"id":"8a0a444f.751b78","type":"tab","label":"Interfaz Teléfono","disabled":false,"info":""},{"id":"2acc8810.81c7a8","type":"tab","label":"On Init","disabled":false,"info":""},{"id":"2ce33584.a2bf7a","type":"tab","label":"Chat","disabled":false,"info":""},{"id":"8acaa1db.06f6a","type":"tab","label":"MQTT","disabled":false,"info":""},{"id":"28e94e1a.327fa2","type":"tab","label":"Telegram","disabled":false,"info":""},{"id":"df558687.1df838","type":"tab","label":"Cámara+QR","disabled":false,"info":""},{"id":"c7c81a64.db1438","type":"tab","label":"Sistema (Exec)","disabled":false,"info":""},{"id":"f24f522c.5061","type":"tab","label":"Salidas GPIO","disabled":false,"info":""},{"id":"8a7ddc8.106792","type":"tab","label":"Ngrok","disabled":false,"info":""},{"id":"6e643c60.b53764","type":"tab","label":"Radar","disabled":true,"info":""},{"id":"2da2b35e.ce678c","type":"subflow","name":"GoogleHomeNotification","info":"","in":[{"x":50,"y":30,"wires":[{"id":"687a9f02.3bc6d"}]}],"out":[]},{"id":"ad6ed8bd.649658","type":"ui_tab","z":"","name":"Autónomo","icon":"dashboard","order":2,"disabled":false,"hidden":false},{"id":"6f7c3b98.411e14","type":"ui_group","z":"","name":"Setup","tab":"ad6ed8bd.649658","order":2,"disp":true,"width":"6","collapse":false},{"id":"8714eca8.27de2","type":"mqtt-broker","z":"","name":"","broker":"iot.inventoteca.com","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"504d9cda.7d0854","type":"ui_group","z":"","name":"WiFi","tab":"9c9c4a97.ee0658","order":2,"disp":true,"width":"6","collapse":true},{"id":"9c9c4a97.ee0658","type":"ui_tab","z":"","name":"Sistema","icon":"dashboard","order":3,"disabled":false,"hidden":false},{"id":"aaad0e65.b3469","type":"ui_group","z":"","name":"Botones","tab":"406d2d02.248ea4","order":1,"disp":false,"width":"6","collapse":false},{"id":"d0600652.9f6778","type":"ui_group","z":"","name":"Apagar","tab":"9c9c4a97.ee0658","order":1,"disp":true,"width":"6","collapse":false},{"id":"406d2d02.248ea4","type":"ui_tab","z":"","name":"Control","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"e8574371.228a7","type":"ui_group","z":"","name":"Parámetros de Manejo","tab":"9c9c4a97.ee0658","order":3,"disp":true,"width":"6","collapse":true},{"id":"30684173.e2231e","type":"googlehome-config-node-offline","z":"2da2b35e.ce678c","ipaddress":"192.168.20.194","name":"Google Home","language":"fr"},{"id":"e12130ea.34705","type":"googlehome-config-node-offline","z":"2da2b35e.ce678c","ipaddress":"192.168.20.197","name":"Google Home Mini","language":"fr"},{"id":"5ebdb320.8a967c","type":"googlehome-config-node-offline","z":"","ipaddress":"192.168.68.100","name":"Inventoteca Home Mini","language":"es"},{"id":"3ad0e292.3924ce","type":"telegrambot-config","z":"","botname":"Bot","usernames":"","chatIds":"","pollInterval":"300"},{"id":"7ab72cee.d66ef4","type":"telegrambot-config","z":"","botname":"RedFire","usernames":"","chatIds":"","pollInterval":"300"},{"id":"ba3161ad.ad06c","type":"telegrambot-config","z":"","botname":"GrinGreen","usernames":"","chatIds":"","pollInterval":"300"},{"id":"481c6ac5.fe0064","type":"telegrambot-config","z":"","botname":"Blacky","usernames":"","chatIds":"","pollInterval":"300"},{"id":"a11bd592.023a08","type":"ngrokauth","z":""},{"id":"888763d9.0630f","type":"ui_spacer","name":"spacer","group":"","order":2,"width":2,"height":1},{"id":"8aec13bf.df449","type":"ui_spacer","name":"spacer","group":"","order":6,"width":2,"height":1},{"id":"a0762b44.9a3e38","type":"ui_spacer","name":"spacer","group":"","order":7,"width":2,"height":1},{"id":"a9dc8d06.e364a","type":"ui_spacer","name":"spacer","group":"","order":8,"width":4,"height":1},{"id":"d0c3f5e8.a71c98","type":"ui_group","z":"","d":true,"name":"ButtonTab","tab":"1253e0b8.71402f","disp":true,"width":"6","collapse":false},{"id":"1253e0b8.71402f","type":"ui_tab","z":"","name":"Botones bonitos","icon":"dashboard","disabled":true,"hidden":true},{"id":"8438e055.bb7f8","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#08383a","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#097479","value":"#08383a","edited":true},"page-titlebar-backgroundColor":{"value":"#08383a","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#11797d","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#08383a","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"VAPRI Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"b0fb7949.83f988","type":"ui_group","name":"Group 3","tab":"406d2d02.248ea4","order":4,"disp":true,"width":6},{"id":"86fbfdda.0813b","type":"ui_group","z":"","name":"Funciones Avanzadas","tab":"406d2d02.248ea4","order":3,"disp":true,"width":"6","collapse":true},{"id":"e6f366f9.1e9da8","type":"ui_group","z":"","name":"Otros","tab":"9c9c4a97.ee0658","order":5,"disp":true,"width":"6","collapse":false},{"id":"83c8b6f2.72f7f8","type":"ui_spacer","name":"spacer","group":"aaad0e65.b3469","order":14,"width":6,"height":1},{"id":"5b045f76.22d7b","type":"ui_group","z":"","name":"Personalizar VAPRI","tab":"9c9c4a97.ee0658","order":4,"disp":true,"width":"6","collapse":false},{"id":"62bf157d.de35fc","type":"ui_group","z":"","name":"Mediciones","tab":"ad6ed8bd.649658","disp":true,"width":"6","collapse":false},{"id":"57710af4.c4e894","type":"googlehome-notifier-offline","z":"2da2b35e.ce678c","server":"30684173.e2231e","name":"Google Home","x":800,"y":180,"wires":[]},{"id":"bfd9c137.14da6","type":"googlehome-notifier-offline","z":"2da2b35e.ce678c","server":"e12130ea.34705","name":"Google Home Mini","x":790,"y":320,"wires":[]},{"id":"687a9f02.3bc6d","type":"change","z":"2da2b35e.ce678c","name":"","rules":[{"t":"set","p":"cacheFolder","pt":"msg","to":"d:\\tmp\\GHCache","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":200,"y":260,"wires":[["73c28399.48fcdc"]]},{"id":"68d81c97.1e1124","type":"rpi-srf","z":"6e643c60.b53764","name":"Frente","topic":"SRF","pulse":"0.06","pins":"21,22","x":130,"y":200,"wires":[["692fd1b9.48548","81757720.81e0d8"]]},{"id":"5849be9d.21c88","type":"pi-gpiod out","z":"f24f522c.5061","name":"Izquierda-B","host":"localhost","port":8888,"pin":"22","set":"","level":"0","out":"pwm","sermin":"1000","sermax":"2000","x":690,"y":420,"wires":[]},{"id":"b4c0a508.ed7e08","type":"pi-gpiod out","z":"f24f522c.5061","name":"Izquierda-A","host":"localhost","port":8888,"pin":"23","set":"","level":"0","out":"pwm","sermin":"1000","sermax":"2000","x":690,"y":360,"wires":[]},{"id":"d7bdd076.91bd4","type":"pi-gpiod out","z":"f24f522c.5061","name":"Derecha-B","host":"localhost","port":8888,"pin":"18","set":"","level":"0","out":"pwm","sermin":"1000","sermax":"2000","x":690,"y":540,"wires":[]},{"id":"c5c2a14d.ba08d","type":"pi-gpiod out","z":"f24f522c.5061","name":"Derecha-A","host":"localhost","port":8888,"pin":"17","set":"","level":"0","out":"pwm","sermin":"1000","sermax":"2000","x":690,"y":480,"wires":[]},{"id":"bee2f959.7c1fd8","type":"inject","z":"6e643c60.b53764","name":"","topic":"","payload":"","payloadType":"str","repeat":"0.1","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":380,"wires":[["e5dc70e7.7f0fd"]]},{"id":"288cb4a8.31155c","type":"function","z":"6e643c60.b53764","name":"barrido-sensor","func":"var pos = global.get('posRadar');\nvar subida = flow.get('subida');\nvar dist = flow.get('dist')\n//var posiciones = flow.get();\n\nif(subida === true)\n{\n  pos = pos +5;\n  if(pos >= 75)\n  {\n      flow.set('subida',false);\n      pos = 75;\n  }\n}\nelse\n{\n  pos = pos -5;\n  if(pos <= 20)\n  {\n      flow.set('subida',true);\n      pos = 20;\n  }\n}\n\n\nvar msg2 = {payload: pos}\n\nmsg = {topic: pos.toString()};\nmsg = {payload: dist};\nglobal.set('posRadar',pos);\nflow.set('posAtr',pos + 75);\n\n\nreturn [msg,msg2];","outputs":2,"noerr":0,"x":480,"y":380,"wires":[[],["45938d63.ca6944","bb65e17a.9b4e7"]]},{"id":"e5dc70e7.7f0fd","type":"switch","z":"6e643c60.b53764","name":"radar?","property":"radar","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":310,"y":380,"wires":[["288cb4a8.31155c"]]},{"id":"1c94bfa4.6ba62","type":"change","z":"6e643c60.b53764","name":"","rules":[{"t":"set","p":"dist","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":200,"wires":[["a9e3f6a1.aca688"]]},{"id":"a9e3f6a1.aca688","type":"change","z":"6e643c60.b53764","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"posRadar","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":200,"wires":[["b6b6b4e8.533a18","ae53b0a9.a103f","484c4e44.859f3"]]},{"id":"692fd1b9.48548","type":"smooth","z":"6e643c60.b53764","name":"","property":"payload","action":"mean","count":"3","round":"0","mult":"single","reduce":true,"x":260,"y":200,"wires":[["1c94bfa4.6ba62","9457a1e2.c169a"]]},{"id":"6ec5a35c.a502cc","type":"inject","z":"c7c81a64.db1438","name":"","topic":"","payload":"sudo reboot","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":120,"wires":[["fb4be1f9.47d6"]]},{"id":"fb4be1f9.47d6","type":"exec","z":"c7c81a64.db1438","command":"sudo reboot now","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":450,"y":120,"wires":[[],[],[]]},{"id":"51e4d789.83dac8","type":"inject","z":"c7c81a64.db1438","name":"","topic":"","payload":"sudo halt","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":200,"wires":[["9356fa74.5fdb88"]]},{"id":"b6b6b4e8.533a18","type":"function","z":"6e643c60.b53764","name":"direccion-automatica","func":"var pos = msg.topic;\nvar dist = msg.payload;\nvar posiciones = global.get('posiciones')|| Array(10);\nvar max;\nvar sector;\nvar distMin = global.get('distMin')||100;  // Distancia minima\nvar distProm = global.get('distProm')||distMin;\n\npos = (pos/5)-4;\n \nposiciones[pos] = dist;\n\nmax = Math.max.apply(null,posiciones);\nsector = posiciones.indexOf(max);\n\nif((max < distMin) || (distProm < distMin))\n{\n    global.set('reversa',true);\n}\nelse\n{\n   global.set('reversa',false); \n}\n\nglobal.set('posiciones',posiciones);\nglobal.set('max',max);\nglobal.set('sector',sector);\n\nmsg = {payload:sector};\nvar msg2 = {payload:max};\n\nreturn [msg,msg2];","outputs":2,"noerr":0,"x":820,"y":160,"wires":[["64cee509.e27c3c"],[]]},{"id":"10cd3a6b.49ff16","type":"function","z":"f24f522c.5061","name":"motores","func":"var reversa = global.get('reversa');\nvar radar = global.get('radar');\nvar auto = global.get('auto');\nvar motDA, motDB, motIA, motIB;\nvar velMax = global.get('velMax')||100;\nvar pwmD = velMax;\nvar pwmI = velMax;\nvar sector = global.get('sector')||5;\nvar motores = global.get('motores')||false;\n\n\n\nif(reversa === true)\n{\n    if((sector < 4)) // Esta libre la izquierda\n    {\n       pwmI = velMax;\n       pwmD = velMax - (Math.abs((sector - 4)*10));\n    }\n    else if(sector > 5) // esta libre la derecha\n    {\n        pwmI = velMax - (Math.abs((5 - sector)*10));\n        pwmD = velMax;\n    }\n    else\n    {\n        pwmI= velMax;\n        pwmD = velMax;\n    }\n}\nelse\n{\n   if((sector < 4)) // Esta libre la izquierda\n    {\n       pwmI = velMax - (Math.abs((sector - 4)*10));\n       pwmD = velMax;\n    }\n    else if(sector > 5) // esta libre la derecha\n    {\n        pwmI = velMax;\n        pwmD = velMax - (Math.abs((5 - sector)*10));\n    }\n    else\n    {\n        pwmI= velMax;\n        pwmD = velMax;\n    } \n}\n\nif((reversa === true) && ((auto === true) || motores === true)) // No hay reversa\n{\n    motDA = {payload:0};\n    motDB = {payload:pwmD};\n    motIA = {payload:0};\n    motIB = {payload:pwmI};\n}\nelse if((reversa === false) && ((auto === true) || (motores === true)))\n{\n    motDA = {payload:pwmD};\n    motDB = {payload:0};\n    motIA = {payload:pwmI};\n    motIB = {payload:0};\n}\nelse\n{\n    motDA = {payload:0};\n    motDB = {payload:0};\n    motIA = {payload:0};\n    motIB = {payload:0};\n}\n\nreturn [motIA,motIB,motDA,motDB];","outputs":4,"noerr":0,"x":280,"y":460,"wires":[["215c12fb.7a975e"],["af213fec.ce1d5"],["7b3dabeb.064624"],["f9bf105b.4e1d8"]]},{"id":"8db34a58.037c88","type":"link in","z":"f24f522c.5061","name":"motores-radar","links":["1ebd748.7289e8c","d10ead93.65bb1","29e623d1.4757fc","796ec44a.ba074c","f37ac82d.0122b8"],"x":155,"y":460,"wires":[["10cd3a6b.49ff16"]]},{"id":"bfc90e45.ae98b","type":"ui_slider","z":"d47f9ae6.2bf798","name":"","label":"Velocidad Máxima","tooltip":"","group":"e8574371.228a7","order":1,"width":0,"height":0,"passthru":false,"outs":"end","topic":"","min":"35","max":"100","step":1,"x":270,"y":100,"wires":[["d6281bc8.ce6578"]]},{"id":"d6281bc8.ce6578","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"velMax","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":100,"wires":[[]]},{"id":"2c6f0431.92709c","type":"smooth","z":"6e643c60.b53764","name":"","property":"payload","action":"mean","count":"6","round":"0","mult":"single","reduce":true,"x":260,"y":240,"wires":[[]]},{"id":"9457a1e2.c169a","type":"change","z":"6e643c60.b53764","name":"","rules":[{"t":"set","p":"distProm","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":240,"wires":[["4e6d5772.618108"]]},{"id":"7949855e.5454ac","type":"link out","z":"d47f9ae6.2bf798","name":"ui-agregar-wifi","links":["ae68b855.e51c28"],"x":1055,"y":460,"wires":[]},{"id":"ad14a7fc.241638","type":"link in","z":"d47f9ae6.2bf798","name":"ui-ssid","links":["cebb0268.fd78c"],"x":775,"y":440,"wires":[["bcfbcad0.4ccd28"]]},{"id":"ae68b855.e51c28","type":"link in","z":"c7c81a64.db1438","name":"sistema-agregar-wifi","links":["7949855e.5454ac"],"x":720,"y":116,"wires":[["653a12c5.159f1c"]]},{"id":"62d450c3.edc9a","type":"comment","z":"c7c81a64.db1438","name":"Agregar WiFi","info":"","x":770,"y":60,"wires":[]},{"id":"e97c7c4b.9868b","type":"exec","z":"c7c81a64.db1438","command":"hostname -I","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":310,"y":520,"wires":[["1a8c4323.2dc83d","e1a82bb2.bb5d98"],["e1a82bb2.bb5d98"],["e1a82bb2.bb5d98"]]},{"id":"1a8c4323.2dc83d","type":"link out","z":"c7c81a64.db1438","name":"sistema-respuesta-ip","links":["eb46a588.815758","a8c90c1a.b31fe"],"x":435,"y":480,"wires":[]},{"id":"cec73ff.2b7e5c","type":"comment","z":"c7c81a64.db1438","name":"IP","info":"","x":90,"y":460,"wires":[]},{"id":"e1a82bb2.bb5d98","type":"debug","z":"c7c81a64.db1438","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":490,"y":560,"wires":[]},{"id":"3ef416b2.6eb09a","type":"ui_text","z":"d47f9ae6.2bf798","group":"504d9cda.7d0854","order":4,"width":0,"height":0,"name":"Show IP","label":"IP","format":"{{msg.payload}}","layout":"row-spread","x":1060,"y":560,"wires":[]},{"id":"a8c90c1a.b31fe","type":"link in","z":"d47f9ae6.2bf798","name":"ui-ip","links":["1a8c4323.2dc83d"],"x":775,"y":560,"wires":[["3ef416b2.6eb09a"]]},{"id":"640c31e4.feb4c","type":"inject","z":"c7c81a64.db1438","name":"IP Check","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"onceDelay":"60","x":130,"y":520,"wires":[["e97c7c4b.9868b"]]},{"id":"a1c4e8da.61a1c8","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"Adelante","order":5,"width":2,"height":1,"format":"<div class=\"momentaryad vibrate filled touched bigfont rounded\" style=\"background-color:#c0392b\">\n<center>\n<md-button class=\"filled touched bigfont rounded\" style=\"background-color:#c0392b\"> \n    <i class=\"fa fa-arrow-up fa-2x\"></i>\n</md-button>\n</center>\n</div>\n<script>\n(function($scope) {\n$('.momentaryad').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior}\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 1});\n});\n\n$('.momentaryad').on('touchend mouseup', function(e) {\n    e.preventDefault(); //prevent default behavior\n    $scope.send({\"payload\": 0});\n});\n})(scope);\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":220,"y":320,"wires":[["f0ad2c09.36e9d","9b8e3ad1.188148","5b707dfa.6f2f14"]]},{"id":"6aafc95f.643588","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"Arriba Der","order":6,"width":2,"height":1,"format":"<div class=\"momentaryder vibrate filled touched bigfont rounded\" style=\"background-color:#c0392b\">\n<center>\n<md-button class=\"filled touched bigfont rounded\" style=\"background-color:#c0392b\">  \n   <i class=\"fa fa-reply fa-2x fa-flip-horizontal\" aria-hidden=\"true\"></i>\n<script>\n(function($scope) {\n$('.momentaryder').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 1});\n});\n\n$('.momentaryder').on('touchend mouseup', function(e) {\n    e.preventDefault(); //prevent default behavior\n    $scope.send({\"payload\": 0});\n});\n})(scope);\n</script>\n</md-button>\n</center>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":220,"y":160,"wires":[["9b8e3ad1.188148","5b707dfa.6f2f14","d4f61c77.1ddcf"]]},{"id":"ca62b602.498198","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"der (Bolt)","order":9,"width":2,"height":1,"format":"<div class=\"momentaryarder vibrate filled touched bigfont rounded\" style={{(msg.color)}}>\n<center>\n<md-button class=\"filled touched bigfont rounded\" style={{(msg.color)}}>  \n    <i class={{(msg.logoSmall)}}></i>\n    <i class={{(msg.logo)}}></i>\n    <i class={{(msg.logoSmall)}}></i>\n</md-button> \n</center>\n</div>\n<script>\n\n(function($scope) {\n$('.momentaryarder').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 0});\n});\n\n})(scope);\n</script>\n\n","storeOutMessages":true,"fwdInMessages":false,"templateScope":"local","x":1960,"y":440,"wires":[["32be4c2.b8315b4"]]},{"id":"1c6a3b7a.31bea5","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"Arriba Izq","order":4,"width":2,"height":1,"format":"<div class=\"momentaryiz vibrate filled touched bigfont rounded\" style=\"background-color:#c0392b\">\n<center>\n<md-button class=\"filled touched bigfont rounded\" style=\"background-color:#c0392b\"> \n    <i class=\"fa fa-reply fa-2x\" aria-hidden=\"true\"></i>\n</md-button>\n</center>\n</div>\n<script>\n(function($scope) {\n$('.momentaryiz').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 1});\n});\n\n$('.momentaryiz').on('touchend mouseup', function(e) {\n    e.preventDefault(); //prevent default behavior\n    $scope.send({\"payload\": 0});\n});\n})(scope);\n</script>\n\n","storeOutMessages":true,"fwdInMessages":false,"templateScope":"local","x":220,"y":240,"wires":[["9b8e3ad1.188148","5b707dfa.6f2f14","f3a1664a.955918"]]},{"id":"20939e98.8a7e82","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"abajo iz","order":10,"width":2,"height":1,"format":" <div class=\"momentaryabiz vibrate filled touched bigfont rounded\" style=\"background-color:#c0392b\">\n<center>\n<md-button class=\"filled touched bigfont rounded\" style=\"background-color:#c0392b\"> \n    <i class=\"fa fa-reply fa-2x fa-flip-vertical\"></i>\n</md-button>\n</center>\n</div>\n\n<script>\n(function($scope) \n{\n$('.momentaryabiz').on('touchstart mousedown', function(e) \n    {\n        e.preventDefault(); //prevent default behavior\n        navigator.vibrate(30);\n        $scope.send({\"payload\": 1});\n    });\n\n$('.momentaryabiz').on('touchend mouseup', function(e) \n    {\n        e.preventDefault(); //prevent default behavior\n        $scope.send({\"payload\": 0});\n    });\n})(scope);\n</script>\n\n\n","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":220,"y":280,"wires":[["5e104a21.ae1d34","9b8e3ad1.188148","6075b1d5.27579"]]},{"id":"e9c4a97d.0c4648","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"Atrás","order":11,"width":2,"height":1,"format":"<div class=\"momentaryat vibrate filled touched bigfont rounded\" style=\"background-color:#c0392b\">\n<center>\n<md-button \n   class=\"filled touched bigfont rounded\" \n   style=\"background-color:#c0392b\">\n   <i class=\"fa fa-arrow-down fa-2x\" aria-hidden=\"true\"></i>\n</md-button> \n</center>\n<script>\n(function($scope) {\n$('.momentaryat').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 1});\n});\n\n$('.momentaryat').on('touchend mouseup', function(e) {\n    e.preventDefault(); //prevent default behavior\n    $scope.send({\"payload\": 0});\n});\n})(scope);\n</script>\n</div>\n\n\n","storeOutMessages":true,"fwdInMessages":false,"templateScope":"local","x":210,"y":360,"wires":[["5e104a21.ae1d34","f0ad2c09.36e9d","9b8e3ad1.188148"]]},{"id":"b27367bd.8164a8","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"abajo der","order":12,"width":2,"height":1,"format":"<div class=\"momentaryabder vibrate filled bigfont rounded\" style=\"background-color:#c0392b\">\n<center>\n<md-button class=\"bigfont rounded\" style=\"background-color:#c0392b\"> \n    <i class=\"fa fa-reply fa-2x fa-rotate-180\"></i>\n</md-button> \n</center>\n</div>\n<script>\n(function($scope) {\n$('.momentaryabder').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 1});\n});\n\n$('.momentaryabder').on('touchend mouseup', function(e) {\n    e.preventDefault(); //prevent default behavior\n    $scope.send({\"payload\": 0});\n});\n})(scope);\n</script>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":220,"y":200,"wires":[["5e104a21.ae1d34","9b8e3ad1.188148","4078384e.73ab28"]]},{"id":"5b707dfa.6f2f14","type":"change","z":"8a0a444f.751b78","name":"Adelante","rules":[{"t":"set","p":"reversa","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":980,"y":500,"wires":[["d10ead93.65bb1"]]},{"id":"5e104a21.ae1d34","type":"change","z":"8a0a444f.751b78","name":"Reversa","rules":[{"t":"set","p":"reversa","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":460,"wires":[["d10ead93.65bb1"]]},{"id":"74c9bae3.de5574","type":"change","z":"8a0a444f.751b78","name":"RightLimit","rules":[{"t":"set","p":"payload","pt":"msg","to":"limiteDer","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":160,"wires":[["cccc7c21.b418b"]]},{"id":"80f72754.dc8e98","type":"change","z":"8a0a444f.751b78","name":"LeftLimit","rules":[{"t":"set","p":"payload","pt":"msg","to":"limiteIzq","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":240,"wires":[["cccc7c21.b418b"]]},{"id":"f0ad2c09.36e9d","type":"change","z":"8a0a444f.751b78","name":"Center","rules":[{"t":"set","p":"payload","pt":"msg","to":"centro","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":320,"wires":[["cccc7c21.b418b"]]},{"id":"2ca14cba.ca5e94","type":"link out","z":"6e643c60.b53764","name":"radar-volante","links":["3b540816.53f838","6ab354ed.4d350c","3c4070fc.4b028","d3e3d9ee.ced988","85317f40.3f73b"],"x":1075,"y":160,"wires":[]},{"id":"cccc7c21.b418b","type":"link out","z":"8a0a444f.751b78","name":"telefono-volante","links":["85317f40.3f73b"],"x":1155,"y":240,"wires":[]},{"id":"64cee509.e27c3c","type":"switch","z":"6e643c60.b53764","name":"auto?","property":"auto","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":990,"y":160,"wires":[["2ca14cba.ca5e94"]]},{"id":"f6e04abd.ce2ec8","type":"ui_button","z":"d47f9ae6.2bf798","name":"","group":"d0600652.9f6778","order":0,"width":0,"height":0,"passthru":false,"label":"Apagar","tooltip":"","color":"","bgcolor":"","icon":"","payload":"¿Apagar?","payloadType":"str","topic":"","x":820,"y":100,"wires":[["9711f5ab.810148"]]},{"id":"b30fea42.8f09c8","type":"link out","z":"d47f9ae6.2bf798","name":"from-ui-apagar","links":["91bf57d9.5736c8"],"x":1135,"y":100,"wires":[]},{"id":"cb98fd1d.23657","type":"link in","z":"c7c81a64.db1438","name":"sistema-reiniciar","links":["6a520e15.ac8b1"],"x":275,"y":80,"wires":[["fb4be1f9.47d6"]]},{"id":"336f0e98.bcdc52","type":"ui_button","z":"d47f9ae6.2bf798","name":"","group":"d0600652.9f6778","order":0,"width":0,"height":0,"passthru":false,"label":"Reiniciar","tooltip":"","color":"","bgcolor":"","icon":"","payload":"¿Reiniciar?","payloadType":"str","topic":"","x":820,"y":140,"wires":[["e65e5b3.c4713a8"]]},{"id":"d10ead93.65bb1","type":"link out","z":"8a0a444f.751b78","name":"telefono-motores","links":["8db34a58.037c88"],"x":1215,"y":480,"wires":[]},{"id":"ae53b0a9.a103f","type":"switch","z":"6e643c60.b53764","name":"auto?","property":"auto","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":990,"y":200,"wires":[["29e623d1.4757fc"]]},{"id":"5d87f446.5825fc","type":"change","z":"8a0a444f.751b78","name":"Control temporal","rules":[{"t":"set","p":"temporal","pt":"global","to":"auto","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":380,"wires":[["cbfa561c.1bfcf8"]]},{"id":"9b8e3ad1.188148","type":"switch","z":"8a0a444f.751b78","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":400,"wires":[["87dca041.c8536"],["171d428f.baef4d"]]},{"id":"cbfa561c.1bfcf8","type":"change","z":"8a0a444f.751b78","name":"auto off","rules":[{"t":"set","p":"auto","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":380,"wires":[["d10ead93.65bb1"]]},{"id":"171d428f.baef4d","type":"change","z":"8a0a444f.751b78","name":"Control temporal","rules":[{"t":"set","p":"auto","pt":"global","to":"temporal","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":420,"wires":[["e8cbc4d4.a9b068"]]},{"id":"5b04e46c.ac84ac","type":"inject","z":"df558687.1df838","name":"","topic":"","payload":"","payloadType":"str","repeat":"0.2","crontab":"","once":false,"onceDelay":"5","x":170,"y":140,"wires":[["80038dbe.f9c1e"]]},{"id":"80038dbe.f9c1e","type":"file in","z":"df558687.1df838","name":"","filename":"/dev/shm/mjpeg/cam.jpg","format":"","chunk":false,"sendError":false,"encoding":"none","x":350,"y":140,"wires":[["96526555.fed158","1b3021fd.65ec9e"]]},{"id":"3ff4cfca.a7a2a","type":"template","z":"df558687.1df838","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<img width=\"320px\" height=\"240px\" src=\"data:image/jpg;base64,{{{payload}}}\">","output":"str","x":720,"y":140,"wires":[["844d5169.fb276"]]},{"id":"7f348d82.07eb74","type":"comment","z":"df558687.1df838","name":"Basado en esto: https://elinux.org/RPi-Cam-Web-Interface","info":"","x":850,"y":60,"wires":[]},{"id":"adbf65db.505068","type":"comment","z":"df558687.1df838","name":"Regula el FPS pero causa delay","info":"","x":230,"y":180,"wires":[]},{"id":"75897e37.dffbf","type":"ui_template","z":"df558687.1df838","group":"aaad0e65.b3469","name":"Video","order":3,"width":6,"height":5,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1010,"y":140,"wires":[[]]},{"id":"96526555.fed158","type":"base64","z":"df558687.1df838","name":"","action":"str","property":"payload","x":580,"y":140,"wires":[["3ff4cfca.a7a2a"]]},{"id":"10271fe8.e8c37","type":"comment","z":"df558687.1df838","name":"Habilitar y desplegar para empezar a correr la transmisión de video.","info":"","x":340,"y":60,"wires":[]},{"id":"75569de6.d1f234","type":"rpi-srf","z":"6e643c60.b53764","d":true,"name":"Atras","topic":"SRF","pulse":"0.06","pins":"31,29","x":130,"y":100,"wires":[["a8b3ac43.3828e"]]},{"id":"fc951b33.ccc208","type":"change","z":"6e643c60.b53764","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"posAtr","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":100,"wires":[["81757720.81e0d8"]]},{"id":"a8b3ac43.3828e","type":"smooth","z":"6e643c60.b53764","name":"","property":"payload","action":"mean","count":"3","round":"0","mult":"single","reduce":true,"x":260,"y":100,"wires":[["fc951b33.ccc208"]]},{"id":"d27d3f0c.e4c74","type":"ui_switch","z":"d47f9ae6.2bf798","name":"","label":"Invertir derecha","tooltip":"","group":"e8574371.228a7","order":6,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":260,"y":160,"wires":[["24525b90.45dd74"]]},{"id":"319a0297.77bf0e","type":"ui_switch","z":"d47f9ae6.2bf798","name":"","label":"Invertir izquierda","tooltip":"","group":"e8574371.228a7","order":7,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":270,"y":220,"wires":[["78439edb.9f56b"]]},{"id":"24525b90.45dd74","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"invDer","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":160,"wires":[[]]},{"id":"78439edb.9f56b","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"invIzq","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":220,"wires":[[]]},{"id":"215c12fb.7a975e","type":"switch","z":"f24f522c.5061","name":"izquierda invertida?","property":"invIzq","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":360,"wires":[["b4c0a508.ed7e08"],["5849be9d.21c88"]]},{"id":"af213fec.ce1d5","type":"switch","z":"f24f522c.5061","name":"izquierda invertida?","property":"invIzq","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":440,"wires":[["5849be9d.21c88"],["b4c0a508.ed7e08"]]},{"id":"7b3dabeb.064624","type":"switch","z":"f24f522c.5061","name":"derecha invertida?","property":"invDer","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":480,"wires":[["c5c2a14d.ba08d"],["d7bdd076.91bd4"]]},{"id":"f9bf105b.4e1d8","type":"switch","z":"f24f522c.5061","name":"derecha invertida?","property":"invDer","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":540,"wires":[["d7bdd076.91bd4"],["c5c2a14d.ba08d"]]},{"id":"e8cbc4d4.a9b068","type":"switch","z":"8a0a444f.751b78","name":"T or F","property":"llave","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":830,"y":420,"wires":[["d10ead93.65bb1","b5392880.59b248"],["d10ead93.65bb1","f0ad2c09.36e9d"]]},{"id":"81757720.81e0d8","type":"debug","z":"6e643c60.b53764","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":570,"y":140,"wires":[]},{"id":"75617e3a.4a90e","type":"link out","z":"8a0a444f.751b78","name":"telefono-auto-off","links":["86d2629c.66825","52be6874.1e1168"],"x":815,"y":620,"wires":[]},{"id":"45938d63.ca6944","type":"delay","z":"6e643c60.b53764","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":650,"y":340,"wires":[["9cf91d36.1314e"]]},{"id":"844d5169.fb276","type":"delay","z":"df558687.1df838","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"5","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":870,"y":140,"wires":[["75897e37.dffbf"]]},{"id":"29e623d1.4757fc","type":"link out","z":"6e643c60.b53764","name":"distancia-radar","links":["8db34a58.037c88"],"x":1075,"y":200,"wires":[]},{"id":"d8a99cea.2cc77","type":"comment","z":"6e643c60.b53764","name":"Lecturas de Ultrasónicos","info":"","x":190,"y":60,"wires":[]},{"id":"51d8f941.dca4d8","type":"comment","z":"6e643c60.b53764","name":"Barrido del radar","info":"","x":160,"y":340,"wires":[]},{"id":"540ab9bb.a326b8","type":"comment","z":"c7c81a64.db1438","name":"Básicas ","info":"","x":90,"y":60,"wires":[]},{"id":"4908f29a.6c583c","type":"inject","z":"c7c81a64.db1438","name":"Tomar foto","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":320,"wires":[["f9645fc8.d2d09"]]},{"id":"f9645fc8.d2d09","type":"exec","z":"c7c81a64.db1438","command":"raspistill -rot 90 -o ventana.jpg","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":390,"y":320,"wires":[["b8400210.a1ae9","1f14a9ee.fe4436"],["b8400210.a1ae9"],["b8400210.a1ae9"]]},{"id":"b8400210.a1ae9","type":"debug","z":"c7c81a64.db1438","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":530,"y":260,"wires":[]},{"id":"dde78939.aa0128","type":"exec","z":"c7c81a64.db1438","command":"raspivid -rot 90 -o vid.h264","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":380,"y":380,"wires":[[],[],[]]},{"id":"35fdf8a1.7e84d8","type":"inject","z":"c7c81a64.db1438","name":"Tomar video","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":380,"wires":[["dde78939.aa0128"]]},{"id":"1f14a9ee.fe4436","type":"link out","z":"c7c81a64.db1438","name":"TomarFoto_Begin","links":["74333ea.210e2c"],"x":595,"y":320,"wires":[]},{"id":"9e7c3369.8c727","type":"comment","z":"c7c81a64.db1438","name":"Pruebas cámara","info":"","x":120,"y":260,"wires":[]},{"id":"b4f5426b.863bb","type":"link in","z":"d47f9ae6.2bf798","name":"velMax_End","links":["1a34ed99.aebe62","1eef6b27.270785"],"x":135,"y":100,"wires":[["bfc90e45.ae98b"]]},{"id":"7858fa26.8c0f74","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"velMax","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":200,"y":120,"wires":[["1eef6b27.270785"]]},{"id":"f5952ca4.cee3e","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"distMin","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":200,"y":180,"wires":[["b87b56a6.4a4dd8"]]},{"id":"1eef6b27.270785","type":"link out","z":"2acc8810.81c7a8","name":"velMax_Begin","links":["b4f5426b.863bb"],"x":315,"y":120,"wires":[]},{"id":"b87b56a6.4a4dd8","type":"link out","z":"2acc8810.81c7a8","name":"distMin_Begin","links":["dfafb9ea.6e0b48","f63323c1.16b8e"],"x":315,"y":180,"wires":[]},{"id":"c394a2ca.3e03b","type":"comment","z":"2acc8810.81c7a8","name":"Parámetros de manejo","info":"","x":200,"y":60,"wires":[]},{"id":"babc5f82.ec6ff","type":"comment","z":"d47f9ae6.2bf798","name":"Parámetros de manejo","info":"","x":220,"y":40,"wires":[]},{"id":"36f82ca0.6ae2a4","type":"link in","z":"d47f9ae6.2bf798","name":"ui-key_End","links":["30051913.1ce0c6","fe16bfc1.cd903"],"x":775,"y":480,"wires":[[]]},{"id":"2a95074e.77cfe8","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":true,"onceDelay":"2","x":530,"y":120,"wires":[["b3bfb864.7f2958"]]},{"id":"cebb0268.fd78c","type":"link out","z":"2acc8810.81c7a8","name":"ui-ssid_Begin","links":["ad14a7fc.241638"],"x":1155,"y":240,"wires":[]},{"id":"68f548b1.48e598","type":"comment","z":"2acc8810.81c7a8","name":"Consultar WiFi","info":"","x":540,"y":60,"wires":[]},{"id":"465a2da2.2cc944","type":"comment","z":"d47f9ae6.2bf798","name":"Configuración WiFi","info":"","x":850,"y":380,"wires":[]},{"id":"47605ed4.56f8a","type":"link in","z":"d47f9ae6.2bf798","name":"invDer_End","links":["b50f2514.6d1478","2e3b56a1.a6c79a"],"x":135,"y":160,"wires":[["d27d3f0c.e4c74"]]},{"id":"4d5b3a99.753784","type":"link in","z":"d47f9ae6.2bf798","name":"invIzq_End","links":["a25d4a14.838dc8","d5cda985.b90fe8"],"x":135,"y":220,"wires":[["319a0297.77bf0e"]]},{"id":"4760729b.6ec73c","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"invDer","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":190,"y":240,"wires":[["2e3b56a1.a6c79a"]]},{"id":"39319a66.dc7d36","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"invIzq","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":190,"y":300,"wires":[["d5cda985.b90fe8"]]},{"id":"2e3b56a1.a6c79a","type":"link out","z":"2acc8810.81c7a8","name":"invDer_Begin","links":["47605ed4.56f8a"],"x":315,"y":240,"wires":[]},{"id":"d5cda985.b90fe8","type":"link out","z":"2acc8810.81c7a8","name":"invIzq_Begin","links":["4d5b3a99.753784"],"x":315,"y":300,"wires":[]},{"id":"a09ba2b7.39a51","type":"comment","z":"d47f9ae6.2bf798","name":"Básicos","info":"","x":810,"y":40,"wires":[]},{"id":"c353276c.46da88","type":"ui_slider","z":"d47f9ae6.2bf798","name":"","label":"Volante","tooltip":"","group":"e8574371.228a7","order":2,"width":0,"height":0,"passthru":true,"outs":"end","topic":"","min":"100","max":"0","step":"1","x":440,"y":280,"wires":[["991aa5f6.0b0948"]]},{"id":"991aa5f6.0b0948","type":"link out","z":"d47f9ae6.2bf798","name":"volante_Begin","links":["a0c421c5.23025","85317f40.3f73b"],"x":555,"y":280,"wires":[]},{"id":"3cac1ace.8ebe86","type":"pi-gpiod out","z":"f24f522c.5061","name":"Volante","host":"localhost","port":8888,"pin":"24","set":"","level":"0","out":"ser","sermin":"500","sermax":"2500","x":700,"y":180,"wires":[]},{"id":"2fa37114.fb967e","type":"range","z":"f24f522c.5061","d":true,"minin":"0","maxin":"9","minout":"65","maxout":"25","action":"scale","round":true,"property":"payload","name":"map(0,9,65,25)","x":520,"y":60,"wires":[["3cac1ace.8ebe86","50f2ab79.dbaf14"]]},{"id":"48d370b8.6f525","type":"switch","z":"f24f522c.5061","d":true,"name":"reversa?","property":"reversa","propertyType":"global","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":360,"y":80,"wires":[["2fa37114.fb967e"],["5200506b.8ec47"]]},{"id":"5200506b.8ec47","type":"range","z":"f24f522c.5061","d":true,"minin":"0","maxin":"9","minout":"25","maxout":"65","action":"scale","round":true,"property":"payload","name":"map(0,9,25,65)","x":520,"y":100,"wires":[["3cac1ace.8ebe86","50f2ab79.dbaf14"]]},{"id":"85317f40.3f73b","type":"link in","z":"f24f522c.5061","name":"volante","links":["cccc7c21.b418b","2ca14cba.ca5e94","991aa5f6.0b0948"],"x":155,"y":180,"wires":[["48d370b8.6f525","3cac1ace.8ebe86","f1e26c35.24f5e"]]},{"id":"b58b60c5.bebcf","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":530,"y":300,"wires":[["f8a1ff90.3f4e3"]]},{"id":"f8a1ff90.3f4e3","type":"change","z":"2acc8810.81c7a8","name":"","rules":[{"t":"set","p":"posRadar","pt":"global","to":"20","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":300,"wires":[[]]},{"id":"947965b3.133f28","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":530,"y":340,"wires":[["52213e7e.a102e","968477ed.ba8638"]]},{"id":"52213e7e.a102e","type":"change","z":"2acc8810.81c7a8","name":"","rules":[{"t":"set","p":"motores","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":360,"wires":[[]]},{"id":"8f2fac93.5ff91","type":"inject","z":"2acc8810.81c7a8","name":"centro","topic":"","payload":"42.5","payloadType":"num","repeat":"","crontab":"","once":true,"onceDelay":"10","x":530,"y":380,"wires":[["aadfe424.9c7bb8"]]},{"id":"aadfe424.9c7bb8","type":"link out","z":"2acc8810.81c7a8","name":"ServoPos_Begin","links":["d4e9751.f286c88","d56eef5c.b6b94"],"x":815,"y":380,"wires":[]},{"id":"caf326b4.5fcfb8","type":"comment","z":"2acc8810.81c7a8","name":"Radar","info":"","x":510,"y":240,"wires":[]},{"id":"968477ed.ba8638","type":"link out","z":"2acc8810.81c7a8","name":"InitInFalse","links":["35f88c95.115744","c336970f.f4ff38","fedb5150.7ae25","52be6874.1e1168"],"x":815,"y":340,"wires":[]},{"id":"796ec44a.ba074c","type":"link out","z":"d47f9ae6.2bf798","name":"distancia-radar","links":["8db34a58.037c88"],"x":2015,"y":140,"wires":[]},{"id":"2c4ef188.1c1c9e","type":"ui_switch","z":"d47f9ae6.2bf798","name":"","label":"Autonomo","tooltip":"","group":"86fbfdda.0813b","order":17,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1430,"y":140,"wires":[["49a49a39.bf6634","7d52fded.3a4f64"]]},{"id":"49a49a39.bf6634","type":"change","z":"d47f9ae6.2bf798","name":"global.auto","rules":[{"t":"set","p":"auto","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1870,"y":140,"wires":[["796ec44a.ba074c","2c4ef188.1c1c9e"]]},{"id":"93524585.c86528","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"radar","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1860,"y":240,"wires":[["acb53a7a.ce66a8"]]},{"id":"7d52fded.3a4f64","type":"switch","z":"d47f9ae6.2bf798","name":"true check","property":"payload","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1650,"y":180,"wires":[["1654c7f1.91bc38","93524585.c86528"]]},{"id":"1654c7f1.91bc38","type":"switch","z":"d47f9ae6.2bf798","name":"false check","property":"payload","propertyType":"msg","rules":[{"t":"false"}],"checkall":"true","repair":false,"outputs":1,"x":1650,"y":220,"wires":[["49a49a39.bf6634","93524585.c86528"]]},{"id":"52be6874.1e1168","type":"link in","z":"d47f9ae6.2bf798","name":"toGlobal.Auto","links":["75617e3a.4a90e","968477ed.ba8638"],"x":1735,"y":140,"wires":[["49a49a39.bf6634"]]},{"id":"c336970f.f4ff38","type":"link in","z":"d47f9ae6.2bf798","name":"InitinFalse","links":["968477ed.ba8638"],"x":1295,"y":240,"wires":[["acb53a7a.ce66a8"]]},{"id":"acb53a7a.ce66a8","type":"ui_switch","z":"d47f9ae6.2bf798","name":"RadarBotones","label":"Radar","tooltip":"","group":"86fbfdda.0813b","order":16,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":1440,"y":240,"wires":[["1654c7f1.91bc38"]]},{"id":"ec064d07.1fa8e","type":"comment","z":"d47f9ae6.2bf798","name":"Switches Radar (Explicación)","info":"El switch autónomo enciende el modo autónomo y el radar pero sólo apaga el modo, el switch de radar sólo controla el radar.","x":1400,"y":80,"wires":[]},{"id":"d17d0323.cb2b7","type":"inject","z":"2acc8810.81c7a8","name":"centro","topic":"","payload":"centro","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":"10","x":170,"y":360,"wires":[["27c7d836.514958"]]},{"id":"27c7d836.514958","type":"link out","z":"2acc8810.81c7a8","name":"volanteSlider_Begin","links":["8eaeaaff.f662a8"],"x":315,"y":360,"wires":[]},{"id":"4e6d5772.618108","type":"link out","z":"6e643c60.b53764","name":"distRegistrada_Begin","links":["a65ae476.129c68","d5dba0cf.0c3bd"],"x":615,"y":240,"wires":[]},{"id":"484c4e44.859f3","type":"link out","z":"6e643c60.b53764","name":"radarDash_Begin","links":[],"x":735,"y":240,"wires":[]},{"id":"9cf91d36.1314e","type":"link out","z":"6e643c60.b53764","name":"ServoPosSlider_Begin","links":["99405ba8.c2ecd8","e08490f9.fda74"],"x":755,"y":340,"wires":[]},{"id":"9badaa9e.957978","type":"ui_chart","z":"d47f9ae6.2bf798","name":"","group":"62bf157d.de35fc","order":4,"width":0,"height":0,"label":"Radar","chartType":"radar","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"150","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":2110,"y":500,"wires":[[]]},{"id":"13749c29.2cdb74","type":"ui_gauge","z":"d47f9ae6.2bf798","name":"","group":"62bf157d.de35fc","order":1,"width":0,"height":0,"gtype":"gage","title":"Distancia para colisión","label":"cm","format":"{{value}}","min":0,"max":"100","colors":["#b50000","#e6e600","#39ca38"],"seg1":"","seg2":"","x":2060,"y":460,"wires":[]},{"id":"2abf2d45.a20002","type":"delay","z":"d47f9ae6.2bf798","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1870,"y":460,"wires":[["13749c29.2cdb74"]]},{"id":"9815df44.24cfa","type":"delay","z":"d47f9ae6.2bf798","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"3","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1890,"y":500,"wires":[["9badaa9e.957978"]]},{"id":"d5dba0cf.0c3bd","type":"link in","z":"d47f9ae6.2bf798","name":"distRegistrada_End","links":["4e6d5772.618108"],"x":1755,"y":460,"wires":[["2abf2d45.a20002"]]},{"id":"b37143fd.cac4","type":"link in","z":"d47f9ae6.2bf798","name":"radarDash_End","links":[],"x":1755,"y":500,"wires":[["9815df44.24cfa"]]},{"id":"b53ffba7.7517d8","type":"comment","z":"d47f9ae6.2bf798","name":"Gráficas Radar","info":"","x":1820,"y":360,"wires":[]},{"id":"bb65e17a.9b4e7","type":"link out","z":"6e643c60.b53764","name":"ServoPos_Begin","links":["d4e9751.f286c88","99405ba8.c2ecd8","d56eef5c.b6b94","e08490f9.fda74"],"x":755,"y":400,"wires":[]},{"id":"c04d279c.6e2758","type":"pi-gpiod out","z":"f24f522c.5061","name":"Servo Sensor","host":"localhost","port":8888,"pin":"10","set":"","level":"0","out":"ser","sermin":"500","sermax":"2500","x":680,"y":300,"wires":[]},{"id":"d56eef5c.b6b94","type":"link in","z":"f24f522c.5061","name":"ServoPos_End","links":["aadfe424.9c7bb8","bb65e17a.9b4e7"],"x":155,"y":300,"wires":[["c04d279c.6e2758"]]},{"id":"7ff268d6.2362f8","type":"comment","z":"f24f522c.5061","name":"Servo Volante","info":"","x":210,"y":80,"wires":[]},{"id":"b5a1744.8231188","type":"comment","z":"f24f522c.5061","name":"Servo Radar","info":"","x":210,"y":260,"wires":[]},{"id":"6eecd835.1a4f08","type":"comment","z":"f24f522c.5061","name":"PWM Motores","info":"","x":210,"y":360,"wires":[]},{"id":"f287132e.71562","type":"ui_slider","z":"d47f9ae6.2bf798","name":"Sensor Slider","label":"Sensor","tooltip":"","group":"62bf157d.de35fc","order":5,"width":0,"height":0,"passthru":false,"outs":"end","topic":"","min":"75","max":"20","step":"0.5","x":2080,"y":420,"wires":[[]]},{"id":"e08490f9.fda74","type":"link in","z":"d47f9ae6.2bf798","name":"ServoPosSlider_End","links":["9cf91d36.1314e","bb65e17a.9b4e7"],"x":1755,"y":420,"wires":[["f287132e.71562"]]},{"id":"187c9815.e5a958","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"Activar GPIOD","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":200,"y":640,"wires":[["5ae14544.d7825c"]]},{"id":"5ae14544.d7825c","type":"exec","z":"2acc8810.81c7a8","command":"sudo pigpiod","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":370,"y":640,"wires":[[],[],[]]},{"id":"9711f5ab.810148","type":"ui_toast","z":"d47f9ae6.2bf798","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"OK","cancel":"","raw":false,"topic":"","name":"","x":990,"y":100,"wires":[["b30fea42.8f09c8"]]},{"id":"7892a413.68d79c","type":"file","z":"c7c81a64.db1438","name":"","filename":"/etc/wpa_supplicant/wpa_supplicant.conf","appendNewline":false,"createDir":true,"overwriteFile":"true","encoding":"none","x":1165,"y":116,"wires":[["2b3da274.fd5e2e"]]},{"id":"2de91eae.2a37b2","type":"link out","z":"8a7ddc8.106792","name":"ToTelegram","links":["59afa785.3eff28"],"x":1175,"y":320,"wires":[]},{"id":"de3a8f54.df47f","type":"function","z":"8a7ddc8.106792","name":"Formato ui","func":"var text = msg.payload;\nmsg.payload='Tu nuevo acceso remoto VAPRI es: '+ text + '/ui';\nreturn msg;","outputs":1,"noerr":0,"x":1010,"y":180,"wires":[["2de91eae.2a37b2"]]},{"id":"71c8e104.c4496","type":"switch","z":"8a7ddc8.106792","name":"filtro \"null\"","property":"payload","propertyType":"msg","rules":[{"t":"nnull"},{"t":"null"}],"checkall":"true","repair":false,"outputs":2,"x":680,"y":180,"wires":[["de3a8f54.df47f"],["b6afe9b7.df53a8"]]},{"id":"16ba750c.df757b","type":"link in","z":"8a7ddc8.106792","name":"toNgrok","links":["7909f21a.35dbbc"],"x":115,"y":180,"wires":[["837e6d6e.51ed8"]]},{"id":"b6afe9b7.df53a8","type":"change","z":"8a7ddc8.106792","name":"Off noti","rules":[{"t":"set","p":"payload","pt":"msg","to":"Acceso ngrok apagado.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1020,"y":220,"wires":[["2de91eae.2a37b2"]]},{"id":"837e6d6e.51ed8","type":"switch","z":"8a7ddc8.106792","name":"topic","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"ui","vt":"str"},{"t":"eq","v":"ssh","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":210,"y":180,"wires":[["35d5a2cd.ff789e"],["67f3662a.ba1948"]]},{"id":"27321f59.bf55c","type":"debug","z":"28e94e1a.327fa2","name":"Telegram","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1320,"y":260,"wires":[]},{"id":"491194d7.6a8fac","type":"function","z":"28e94e1a.327fa2","name":"Formato para Telegram","func":"var text = msg.payload;\nmsg.payload='{\\n\"text\": \"'+ text + '\"\\n}'\n//',\\n\"parse_mode\": \"Markdown\"\nreturn msg;","outputs":1,"noerr":0,"x":1050,"y":280,"wires":[["18c8fef7.d3ed61","27321f59.bf55c"]]},{"id":"59afa785.3eff28","type":"link in","z":"28e94e1a.327fa2","name":"toTelegram","links":["2de91eae.2a37b2","af8bea66.0e6628"],"x":895,"y":280,"wires":[["491194d7.6a8fac"]]},{"id":"82662c3a.46f7e","type":"change","z":"28e94e1a.327fa2","name":"on","rules":[{"t":"set","p":"payload","pt":"msg","to":"on","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":120,"wires":[["5c843bdb.214d74"]]},{"id":"7909f21a.35dbbc","type":"link out","z":"28e94e1a.327fa2","name":"ToNgrok","links":["7c697255.b465fc","1e91adea.262222","16ba750c.df757b"],"x":735,"y":200,"wires":[]},{"id":"f6833f94.68d51","type":"change","z":"28e94e1a.327fa2","name":"off","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":160,"wires":[["5c843bdb.214d74"]]},{"id":"e9b78cb5.60478","type":"telegrambot-command","z":"28e94e1a.327fa2","name":"/vapri","bot":"3ad0e292.3924ce","command":"/vapri","commandType":"str","commandCase":false,"x":110,"y":140,"wires":[["8a09188a.50e6d8"]]},{"id":"8a09188a.50e6d8","type":"telegrambot-switch","z":"28e94e1a.327fa2","name":"","bot":"3ad0e292.3924ce","chatId":"","question":"ui or editor?","answers":["ui","off","ssh"],"outputs":4,"autoAnswerCallback":true,"timeoutValue":"1","timeoutUnits":"min","x":300,"y":140,"wires":[["82662c3a.46f7e"],["f6833f94.68d51"],["70226068.08573"],[]]},{"id":"18c8fef7.d3ed61","type":"telegrambot-payload","z":"28e94e1a.327fa2","name":"Send","bot":"3ad0e292.3924ce","chatId":"","sendMethod":"sendMessage","payload":"","x":1330,"y":300,"wires":[[]]},{"id":"af18da7c.03d1e8","type":"change","z":"28e94e1a.327fa2","name":"timeout","rules":[{"t":"set","p":"payload","pt":"msg","to":"No recibí respuesta","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":240,"wires":[["af8bea66.0e6628"]]},{"id":"492619fe.a3a748","type":"ui_numeric","z":"d47f9ae6.2bf798","name":"","label":"Centro","tooltip":"","group":"e8574371.228a7","order":3,"width":0,"height":0,"wrap":true,"passthru":false,"topic":"","format":"{{value}}","min":0,"max":"100","step":1,"x":230,"y":340,"wires":[["bd2e02b6.64367","c353276c.46da88"]]},{"id":"bd2e02b6.64367","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"centro","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":340,"wires":[[]]},{"id":"3ef0ed96.b228f2","type":"ui_numeric","z":"d47f9ae6.2bf798","name":"","label":"Límite Derecho","tooltip":"","group":"e8574371.228a7","order":4,"width":0,"height":0,"wrap":true,"passthru":false,"topic":"","format":"{{value}}","min":0,"max":"100","step":1,"x":260,"y":400,"wires":[["f8cb6bfc.b72548","c353276c.46da88"]]},{"id":"386c7d78.2d3ae2","type":"ui_numeric","z":"d47f9ae6.2bf798","name":"","label":"Límite Izquierdo","tooltip":"","group":"e8574371.228a7","order":5,"width":0,"height":0,"wrap":true,"passthru":false,"topic":"","format":"{{value}}","min":0,"max":"100","step":1,"x":260,"y":460,"wires":[["312809e3.edd5f6","c353276c.46da88"]]},{"id":"f8cb6bfc.b72548","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"limiteDer","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":400,"wires":[["118659bc.356906"]]},{"id":"312809e3.edd5f6","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"limiteIzq","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":460,"wires":[["e8a14d0f.ab97b"]]},{"id":"c47b381b.6c02b8","type":"link in","z":"d47f9ae6.2bf798","name":"ui-lim-der","links":["6037da28.f3b2b4"],"x":135,"y":400,"wires":[["3ef0ed96.b228f2"]]},{"id":"281fb5bb.71ddfa","type":"link in","z":"d47f9ae6.2bf798","name":"ui-lim-izq","links":["7a9e5cc0.80d0b4"],"x":135,"y":460,"wires":[["386c7d78.2d3ae2"]]},{"id":"50f2ab79.dbaf14","type":"debug","z":"f24f522c.5061","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":710,"y":80,"wires":[]},{"id":"a19ef1b3.46073","type":"link in","z":"d47f9ae6.2bf798","name":"volanteSlider_End","links":["1d751d20.328d13"],"x":135,"y":280,"wires":[["c353276c.46da88"]]},{"id":"8eaeaaff.f662a8","type":"link in","z":"d47f9ae6.2bf798","name":"ui-centro","links":["27c7d836.514958","119e414.cafd7bf"],"x":135,"y":340,"wires":[["492619fe.a3a748"]]},{"id":"fab0bfab.0735f","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"limiteDer","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":"10","x":200,"y":420,"wires":[["6037da28.f3b2b4"]]},{"id":"6037da28.f3b2b4","type":"link out","z":"2acc8810.81c7a8","name":"init-limiteDer","links":["c47b381b.6c02b8"],"x":335,"y":420,"wires":[]},{"id":"455423c0.60c29c","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"limiteIzq","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":"10","x":200,"y":480,"wires":[["7a9e5cc0.80d0b4"]]},{"id":"7a9e5cc0.80d0b4","type":"link out","z":"2acc8810.81c7a8","name":"init-limiteIzq","links":["281fb5bb.71ddfa"],"x":335,"y":480,"wires":[]},{"id":"aa80d906.3655e8","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"Formato Botones","order":18,"width":0,"height":0,"format":"<style>\n  .filled { \n      height: 90% !important;\n\n      padding: 0 !important;\n      margin: 0 !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 15px;\n}\n\n   .smallfont {\n  font-size: 8px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    \n    });\n    \n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":250,"y":120,"wires":[[]]},{"id":"b2c87781.44daa8","type":"change","z":"8a0a444f.751b78","name":"LeftMedio","rules":[{"t":"set","p":"payload","pt":"msg","to":"medioLimiteIzq","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":280,"wires":[["cccc7c21.b418b"]]},{"id":"7eed3f80.e2183","type":"change","z":"8a0a444f.751b78","name":"RightMedio","rules":[{"t":"set","p":"payload","pt":"msg","to":"medioLimiteDer","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":200,"wires":[["cccc7c21.b418b"]]},{"id":"118659bc.356906","type":"function","z":"d47f9ae6.2bf798","name":"","func":"var limiteDer = msg.payload\nvar centro = global.get('centro')\n\nglobal.set('medioLimiteDer', centro - ((centro - limiteDer)/2))\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":400,"wires":[[]]},{"id":"e8a14d0f.ab97b","type":"function","z":"d47f9ae6.2bf798","name":"","func":"var limiteIzq = msg.payload\nvar centro = global.get('centro')\n\nglobal.set('medioLimiteIzq', ((limiteIzq - centro)/2)+centro)\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":460,"wires":[[]]},{"id":"247752f5.809ade","type":"ui_numeric","z":0,"name":"","label":"Centro","tooltip":"","group":"6f7c3b98.411e14","order":7,"width":0,"height":0,"wrap":true,"passthru":false,"topic":"","format":"{{value}}","min":0,"max":"100","step":1,"x":230,"y":400,"wires":[["88846d78.2a08"]]},{"id":"88846d78.2a08","type":"change","z":0,"name":"","rules":[{"t":"set","p":"centro","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":400,"wires":[[]]},{"id":"8f9ae099.00fe5","type":"ui_numeric","z":0,"name":"","label":"Límite Derecho","tooltip":"","group":"6f7c3b98.411e14","order":7,"width":0,"height":0,"wrap":true,"passthru":false,"topic":"","format":"{{value}}","min":0,"max":"100","step":1,"x":260,"y":460,"wires":[["26ff1f77.2034a"]]},{"id":"b847d441.2d5a88","type":"ui_numeric","z":0,"name":"","label":"Límite Izquierdo","tooltip":"","group":"6f7c3b98.411e14","order":7,"width":0,"height":0,"wrap":true,"passthru":false,"topic":"","format":"{{value}}","min":0,"max":"100","step":1,"x":240,"y":520,"wires":[["83fc0200.00413"]]},{"id":"26ff1f77.2034a","type":"change","z":0,"name":"","rules":[{"t":"set","p":"limiteDer","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":460,"wires":[["296ea50e.66c33a"]]},{"id":"83fc0200.00413","type":"change","z":0,"name":"","rules":[{"t":"set","p":"limiteIzq","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":520,"wires":[["27a362ed.bfdebe"]]},{"id":"21311107.6365be","type":"link in","z":0,"name":"ui-lim-der","links":["874fb91b.572f78"],"x":135,"y":460,"wires":[["8f9ae099.00fe5"]]},{"id":"3d6c8254.5b79fe","type":"link in","z":0,"name":"ui-lim-izq","links":["a7dd29b.0a071d8"],"x":115,"y":520,"wires":[["b847d441.2d5a88"]]},{"id":"ff3858e.0ea4ca8","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":710,"y":80,"wires":[]},{"id":"21b38ba7.f97244","type":"link in","z":0,"name":"ui-centro","links":["24acc816.9d3568","119e414.cafd7bf"],"x":115,"y":400,"wires":[["247752f5.809ade"]]},{"id":"25c2c75c.f1a3a8","type":"inject","z":0,"name":"","topic":"","payload":"limiteDer","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":"10","x":200,"y":420,"wires":[["874fb91b.572f78"]]},{"id":"874fb91b.572f78","type":"link out","z":0,"name":"init-limiteDer","links":["21311107.6365be"],"x":335,"y":420,"wires":[]},{"id":"bee827cd.7642e8","type":"inject","z":0,"name":"","topic":"","payload":"limiteIzq","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":"10","x":200,"y":480,"wires":[["a7dd29b.0a071d8"]]},{"id":"a7dd29b.0a071d8","type":"link out","z":0,"name":"init-limiteIzq","links":["3d6c8254.5b79fe"],"x":335,"y":480,"wires":[]},{"id":"c18012c8.ac916","type":"change","z":0,"name":"Color Rojo","rules":[{"t":"set","p":"payload","pt":"msg","to":"background-color:#c0392b","tot":"str"},{"t":"set","p":"colorCentro","pt":"global","to":"background-color:#c0392b","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":440,"wires":[[]]},{"id":"d35857a8.f3d428","type":"change","z":0,"name":"Color Azul","rules":[{"t":"set","p":"payload","pt":"msg","to":"background-color:#009999","tot":"str"},{"t":"set","p":"colorCentro","pt":"global","to":"background-color:#009999","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":520,"wires":[[]]},{"id":"5ccf5614.61ec78","type":"inject","z":0,"name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"0","x":370,"y":560,"wires":[["d35857a8.f3d428"]]},{"id":"541508e3.ec4608","type":"ui_template","z":0,"group":"","name":"blue","order":4,"width":2,"height":2,"format":"\n<md-button class=\"vibrate filled touched bigfont rounded\" style=\"background-color:#2980b9\"   ng-click=\"send({payload: 'Hello World'})\"> \n    Blue<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"x":1030,"y":880,"wires":[[]]},{"id":"6447283b.c53a68","type":"ui_template","z":0,"group":"","name":"green","order":1,"width":2,"height":2,"format":"\n<md-button class=\"filled touched bigfont rounded vibrate\" style=\"background-color:#27ae60\" ng-click=\"send({payload: 'Hello World'})\"> \n    Green<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1030,"y":840,"wires":[[]]},{"id":"6a890c18.da7534","type":"ui_template","z":0,"group":"","name":"","order":3,"width":2,"height":1,"format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#16a085\"   ng-click=\"send({payload: 'Hello World'})\"> \n    Blue<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"x":1040,"y":960,"wires":[[]]},{"id":"55cf792b.7d1018","type":"ui_template","z":0,"group":"","name":"","order":5,"width":2,"height":1,"format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\" ng-click=\"send({payload: 'Hello World'})\"> \n    Red<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"x":1040,"y":920,"wires":[[]]},{"id":"57347f.2266bb8","type":"ui_template","z":0,"group":"","name":"on","order":10,"width":1,"height":1,"format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#34495e\" ng-click=\"send({payload: 'Hello World'})\"> \n    On\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1030,"y":1000,"wires":[[]]},{"id":"5d925610.b6d0b8","type":"ui_template","z":0,"group":"","name":"off","order":9,"width":1,"height":1,"format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#8e44ad\" ng-click=\"send({payload: 'Hello World'})\"> \n    Off\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1030,"y":1040,"wires":[[]]},{"id":"b6a6cfd7.105fc","type":"ui_template","z":0,"group":"aaad0e65.b3469","name":"Formato Botones","order":2,"width":0,"height":0,"format":"<style>\n  .filled { \n      height: 90% !important;\n\n      padding: 0 !important;\n      margin: 0 !important;\n  }\n  .nr-dashboard-template {\n      padding: 0;\n      margin: 0;\n  }\n  \n  .rounded {\n  border-radius: 12px 12px 12px 12px;\n}\n \n   .bigfont {\n  font-size: 18px;\n}\n\n   .smallfont {\n  font-size: 12px;\n}\n  \n</style>\n\n<script>\n$('.vibrate').on('click', function() {\n  navigator.vibrate(100);\n});\n\nfunction restore_bg(x) {\n            $(this).css(\"background-color\", x);\n    };\n\n$('.touched').on('mousedown', function() {\n    \n    var x= $(this).css(\"background-color\");\n    $(this).css(\"background-color\", \"yellow\");\n    \n    setTimeout(restore_bg.bind(this,x),100);\n    \n    });\n    \n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":270,"y":80,"wires":[[]]},{"id":"2fa68488.0814dc","type":"debug","z":0,"name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":590,"y":40,"wires":[]},{"id":"1ca044ff.64926b","type":"inject","z":0,"name":"","topic":"","payload":"colorCentro","payloadType":"global","repeat":"1","crontab":"","once":true,"onceDelay":"0","x":130,"y":560,"wires":[[]]},{"id":"1b8bb9a8.8b12b6","type":"change","z":0,"name":"LeftMedio","rules":[{"t":"set","p":"payload","pt":"msg","to":"medioLimiteIzq","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":160,"wires":[[]]},{"id":"1f7512a7.a063ed","type":"change","z":0,"name":"RightMedio","rules":[{"t":"set","p":"payload","pt":"msg","to":"medioLimiteDer","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":200,"wires":[[]]},{"id":"296ea50e.66c33a","type":"function","z":0,"name":"","func":"var limiteDer = msg.payload\nvar centro = global.get('centro')\n\nglobal.set('medioLimiteDer', centro - ((centro - limiteDer)/2))\nreturn msg;","outputs":1,"noerr":0,"x":720,"y":460,"wires":[[]]},{"id":"27a362ed.bfdebe","type":"function","z":0,"name":"","func":"var limiteIzq = msg.payload\nvar centro = global.get('centro')\n\nglobal.set('medioLimiteIzq', ((limiteIzq - centro)/2)+centro)\nreturn msg;","outputs":1,"noerr":0,"x":710,"y":520,"wires":[[]]},{"id":"54d072ae.15d43c","type":"telegrambot-command","z":0,"name":"hola","bot":"7ab72cee.d66ef4","command":"hola","commandType":"str","commandCase":false,"x":300,"y":700,"wires":[["4cadfe2b.c6f08","b767db84.c8ecf8"]]},{"id":"7a535e5b.4d5c9","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1010,"y":1120,"wires":[]},{"id":"e6cc0d9a.8606e","type":"telegrambot-notify","z":0,"name":"","bot":"7ab72cee.d66ef4","chatId":"","message":"","parseMode":"","x":1020,"y":840,"wires":[]},{"id":"4cadfe2b.c6f08","type":"change","z":0,"name":"","rules":[{"t":"set","p":"fromTelegram","pt":"global","to":"telegram.from.first_name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":840,"wires":[["e89bcb9b.ebfe98"]]},{"id":"e89bcb9b.ebfe98","type":"function","z":0,"name":"","func":"var nombre = global.get('fromTelegram')\n\nmsg.payload = \"Hola \" + nombre\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":840,"wires":[["e6cc0d9a.8606e"]]},{"id":"b767db84.c8ecf8","type":"telegrambot-switch","z":0,"name":"","bot":"7ab72cee.d66ef4","chatId":"","question":"Que quieres?","answers":["Saludar","Foto"],"outputs":3,"autoAnswerCallback":true,"timeoutValue":"1","timeoutUnits":"min","x":440,"y":1040,"wires":[["fb17b175.c1bbc"],["c0265db8.486e"],[]]},{"id":"fb17b175.c1bbc","type":"change","z":0,"name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Ya te estoy saludando","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":960,"wires":[["e6cc0d9a.8606e"]]},{"id":"c75c3e7f.a4e63","type":"telegrambot-payload","z":0,"name":"","bot":"7ab72cee.d66ef4","chatId":"","sendMethod":"","payload":"","x":910,"y":1020,"wires":[["e6cc0d9a.8606e","7a535e5b.4d5c9"]]},{"id":"c0265db8.486e","type":"change","z":0,"name":"preparar metodo","rules":[{"t":"set","p":"method","pt":"msg","to":"sendPhoto","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"{\"photo\": \"/dev/shm/mjpeg/cam.jpg\"}","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":670,"y":1080,"wires":[["c75c3e7f.a4e63"]]},{"id":"7623bb65.2a7704","type":"telegrambot-payload","z":0,"name":"","bot":"7ab72cee.d66ef4","chatId":"","sendMethod":"sendPhoto","payload":"{\n    \"photo\": \"cam.jpg\",\n    \"text\": \"Hello, *world*!\",\n    \"parse_mode\": \"Markdown\"\n}","x":710,"y":1200,"wires":[["58d86f05.3f254","48e1da18.1d30e4"]]},{"id":"213fab3f.f54684","type":"telegrambot-command","z":0,"name":"foto","bot":"7ab72cee.d66ef4","command":"foto","commandType":"str","commandCase":false,"x":270,"y":1200,"wires":[["7623bb65.2a7704","48e1da18.1d30e4"]]},{"id":"58d86f05.3f254","type":"telegrambot-notify","z":0,"name":"","bot":"7ab72cee.d66ef4","chatId":"","message":"","parseMode":"","x":940,"y":1200,"wires":[]},{"id":"48e1da18.1d30e4","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":930,"y":1320,"wires":[]},{"id":"ca180a1f.a773f8","type":"file","z":0,"name":"","filename":"/home/pi/cam.jpg","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":490,"y":320,"wires":[[]]},{"id":"8f6f3097.67781","type":"delay","z":0,"name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":460,"y":260,"wires":[["ca180a1f.a773f8"]]},{"id":"f744c9f2.ebc488","type":"inject","z":"2acc8810.81c7a8","name":"Activar cámara","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"5","x":200,"y":720,"wires":[["5feb4cd2.771204"]]},{"id":"5feb4cd2.771204","type":"exec","z":"2acc8810.81c7a8","command":"./RPi_Cam_Web_Interface/start.sh","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":440,"y":720,"wires":[[],[],[]]},{"id":"f1e26c35.24f5e","type":"pi-gpiod out","z":"f24f522c.5061","name":"Volante","host":"localhost","port":8888,"pin":"26","set":"","level":"0","out":"ser","sermin":"500","sermax":"2500","x":700,"y":240,"wires":[]},{"id":"76b5bf7d.85b0a","type":"comment","z":"f24f522c.5061","name":"Volante duplicado","info":"El servo del Radar ni el Servo del volante en RedFire no sirven correctamente, el tema es dek shield, se agrega un pin extra","x":510,"y":260,"wires":[]},{"id":"19e5f05a.e6ba8","type":"ui_text","z":"2ce33584.a2bf7a","group":"aaad0e65.b3469","order":13,"width":0,"height":0,"name":"Chat","label":"VAPRI Chat","format":"{{msg.payload}}","layout":"col-center","x":790,"y":340,"wires":[]},{"id":"e4b7172b.3effb8","type":"link in","z":"2ce33584.a2bf7a","name":"google-home-chat-global","links":["48973bf0.b336f4","49e40298.f27b0c"],"x":135,"y":340,"wires":[["53a8d605.91e918"]]},{"id":"dca30c03.8b5da","type":"delay","z":"2ce33584.a2bf7a","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":420,"y":340,"wires":[["19e5f05a.e6ba8","8d22a2b.20cf36","b49a2ad1.dfd258"]]},{"id":"53a8d605.91e918","type":"rbe","z":"2ce33584.a2bf7a","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":270,"y":340,"wires":[["dca30c03.8b5da"]]},{"id":"820dbfd8.fa6f5","type":"telegrambot-payload","z":"28e94e1a.327fa2","name":"Al Vapri Chat","bot":"3ad0e292.3924ce","chatId":"-485056029","sendMethod":"sendMessage","payload":"","x":1310,"y":140,"wires":[[]]},{"id":"d9986d05.dcb8d","type":"link in","z":"28e94e1a.327fa2","name":"telegram-VapriChat","links":["efec97dc.3ca2d8"],"x":895,"y":140,"wires":[["25d5ecfd.5a51c4"]]},{"id":"25d5ecfd.5a51c4","type":"function","z":"28e94e1a.327fa2","name":"Formato para Telegram","func":"var text = msg.payload;\nmsg.payload='{\\n\"text\": \"'+ text + '\"\\n}'\n//',\\n\"parse_mode\": \"Markdown\"\nreturn msg;","outputs":1,"noerr":0,"x":1070,"y":140,"wires":[["820dbfd8.fa6f5"]]},{"id":"51b8cd47.94c454","type":"ngrok","z":"8a7ddc8.106792","port":"1880","creds":"a11bd592.023a08","region":"us","proto":"http","subdomain":"","name":"","auth":"","x":530,"y":180,"wires":[["71c8e104.c4496","85ab1a91.89c458"]]},{"id":"876ecb80.0d4388","type":"ui_template","z":"8a0a444f.751b78","group":"d0c3f5e8.a71c98","name":"blue1","order":3,"width":"2","height":"2","format":"\n<md-button class=\"vibrate filled touched bigfont rounded\" style=\"background-color:#2980b9\"   ng-click=\"send({payload: 'Hello World'})\"> \n    Blue<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":490,"y":780,"wires":[[]]},{"id":"d4abbeb3.ec884","type":"ui_template","z":"8a0a444f.751b78","group":"d0c3f5e8.a71c98","name":"red","order":4,"width":"2","height":"2","format":"\n<md-button class=\"vibrate filled touched bigfont rounded\" style=\"background-color:#c0392b\" ng-click=\"send({payload: 'Hello World'})\"> \n    Red<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":350,"y":780,"wires":[[]]},{"id":"5b176e12.494ca","type":"ui_template","z":"8a0a444f.751b78","group":"d0c3f5e8.a71c98","name":"green","order":5,"width":"2","height":"2","format":"\n<md-button class=\"filled touched bigfont rounded vibrate\" style=\"background-color:#27ae60\" ng-click=\"send({payload: 'Hello World'})\"> \n    Green<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"x":350,"y":820,"wires":[[]]},{"id":"806c4820.215298","type":"ui_template","z":"8a0a444f.751b78","group":"d0c3f5e8.a71c98","name":"","order":6,"width":"2","height":"1","format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#16a085\"   ng-click=\"send({payload: 'Hello World'})\"> \n    Greenish<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"x":620,"y":780,"wires":[[]]},{"id":"5ba30b02.54de14","type":"ui_template","z":"8a0a444f.751b78","group":"d0c3f5e8.a71c98","name":"","order":7,"width":"2","height":"1","format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#e67e22\" ng-click=\"send({payload: 'Hello World'})\"> \n    Orange<br/>button\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":480,"y":820,"wires":[[]]},{"id":"212abb4.b8f8044","type":"ui_template","z":"8a0a444f.751b78","group":"d0c3f5e8.a71c98","name":"on prueb","order":1,"width":1,"height":1,"format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#34495e\" ng-click=\"send({payload: 'Hello World'})\"> \n    On\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":220,"y":780,"wires":[[]]},{"id":"79e30641.2b3148","type":"ui_template","z":"8a0a444f.751b78","group":"d0c3f5e8.a71c98","name":"off","order":2,"width":1,"height":1,"format":"\n<md-button class=\"vibrate filled touched smallfont rounded\" style=\"background-color:#8e44ad\" ng-click=\"send({payload: 'Hello World'})\"> \n    Off\n</md-button> \n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":210,"y":820,"wires":[[]]},{"id":"aeaf1499.e70e68","type":"change","z":"8a0a444f.751b78","name":"default style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#34495e","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-rocket fa-lg","tot":"str"},{"t":"set","p":"enableRocket","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":100,"wires":[["852e1499.6d61a8"]]},{"id":"d322776.caa2b88","type":"inject","z":"8a0a444f.751b78","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":"0","x":1610,"y":100,"wires":[["aeaf1499.e70e68"]]},{"id":"c07389f2.b32988","type":"change","z":"8a0a444f.751b78","name":"default style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#34495e","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-bolt fa-lg","tot":"str"},{"t":"set","p":"logoSmall","pt":"msg","to":"fa fa-bolt fa-sm","tot":"str"},{"t":"set","p":"enableBolt","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":360,"wires":[["ca62b602.498198"]]},{"id":"f67e3eb.c443bc","type":"inject","z":"8a0a444f.751b78","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":"0","x":1610,"y":360,"wires":[["c07389f2.b32988"]]},{"id":"c24ea7ba.190e18","type":"ui_text_input","z":"2ce33584.a2bf7a","name":"Chat Input","label":"","tooltip":"Habla aquí","group":"aaad0e65.b3469","order":15,"width":0,"height":0,"passthru":false,"mode":"text","delay":"0","topic":"","x":210,"y":160,"wires":[["70f35242.be8cdc","2c9b2576.b8837a"]]},{"id":"c28a18b7.096d78","type":"link out","z":"2ce33584.a2bf7a","name":"google-home-chat","links":["2329c031.f25de","cb9a6696.a58a08"],"x":995,"y":180,"wires":[]},{"id":"e9dbbf7d.db2f5","type":"mqtt out","z":"8acaa1db.06f6a","name":"","topic":"","qos":"","retain":"","broker":"8714eca8.27de2","x":410,"y":200,"wires":[]},{"id":"2329c031.f25de","type":"link in","z":"8acaa1db.06f6a","name":"chat+mqtt-vapri","links":["212af5c2.097cca","cf4183c4.21ac1","c28a18b7.096d78"],"x":75,"y":200,"wires":[["9a8ced22.26a49"]]},{"id":"67e06e64.bec21","type":"mqtt in","z":"8acaa1db.06f6a","name":"","topic":"/vapris/+/chat","qos":"2","datatype":"auto","broker":"8714eca8.27de2","x":130,"y":260,"wires":[["48973bf0.b336f4"]]},{"id":"48973bf0.b336f4","type":"link out","z":"8acaa1db.06f6a","name":"chat+mqtt-global","links":["e4b7172b.3effb8"],"x":435,"y":260,"wires":[]},{"id":"7a4b080.14014f8","type":"change","z":"8a0a444f.751b78","name":"enable style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#8e44ad","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-rocket fa-lg","tot":"str"},{"t":"set","p":"enableRocket","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":140,"wires":[["852e1499.6d61a8","94f72722.53a738"]]},{"id":"62918225.24aa0c","type":"link in","z":"8a0a444f.751b78","name":"rocketToggle","links":["615399aa.c94dd8","82ed6453.522268"],"x":1335,"y":120,"wires":[["d545e765.cd6d98"]]},{"id":"63b2f46a.d1687c","type":"link in","z":"8a0a444f.751b78","name":"boltToggle","links":["762f0a96.2282b4","26d1f4d8.50726c"],"x":1335,"y":380,"wires":[["238f4055.1418a"]]},{"id":"3f03139d.7aa4fc","type":"change","z":"8a0a444f.751b78","name":"enable style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#8e44ad","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-bolt fa-lg","tot":"str"},{"t":"set","p":"logoSmall","pt":"msg","to":"fa fa-bolt fa-sm","tot":"str"},{"t":"set","p":"enableBolt","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":400,"wires":[["ca62b602.498198","2c5f756e.aca10a"]]},{"id":"9ad037a8.b7ecf8","type":"inject","z":"8a0a444f.751b78","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"0","x":1610,"y":400,"wires":[["3f03139d.7aa4fc"]]},{"id":"92c7839d.ad2bd","type":"inject","z":"8a0a444f.751b78","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"0","x":1610,"y":140,"wires":[["7a4b080.14014f8"]]},{"id":"3700e46f.94265c","type":"comment","z":"8a0a444f.751b78","name":"Poderes: Misil","info":"","x":1390,"y":60,"wires":[]},{"id":"a11d531a.a1573","type":"comment","z":"8a0a444f.751b78","name":"Arranque (Modo Experto)","info":"","x":270,"y":540,"wires":[]},{"id":"9ab3ed02.e64e6","type":"comment","z":"8a0a444f.751b78","name":"Conducción","info":"","x":230,"y":60,"wires":[]},{"id":"852e1499.6d61a8","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"iz (Rocket)","order":7,"width":2,"height":1,"format":"<div class=\"momentaryariz vibrate filled touched bigfont rounded\" style={{(msg.color)}}>\n<center>\n<md-button class=\"filled touched bigfont rounded\" style={{(msg.color)}}> \n    <i class={{(msg.logo)}} aria-hidden=\"true\"></i>\n</md-button>\n</center>\n</div>\n\n<script>\n(function($scope) {\n$('.momentaryariz').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 0});\n});\n\n})(scope);\n</script>\n","storeOutMessages":true,"fwdInMessages":false,"templateScope":"local","x":1990,"y":180,"wires":[["3aac1d14.cf2ae2"]]},{"id":"73c28399.48fcdc","type":"switch","z":"2da2b35e.ce678c","name":"GoogleNotifyDestination","property":"destination","propertyType":"msg","rules":[{"t":"eq","v":"living","vt":"str"},{"t":"eq","v":"bureau","vt":"str"},{"t":"eq","v":"all","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":450,"y":260,"wires":[["57710af4.c4e894"],["bfd9c137.14da6"],["57710af4.c4e894","bfd9c137.14da6"]],"outputLabels":["Google Home","Google Home mini",""]},{"id":"d4f61c77.1ddcf","type":"timed-counter","z":"8a0a444f.751b78","name":"Counter","timelimit":"1","timeunit":"1000","withhold":false,"fixedtimeout":false,"pertopic":false,"x":455,"y":160,"wires":[["ce69bb35.719f58"]],"l":false},{"id":"ce69bb35.719f58","type":"switch","z":"8a0a444f.751b78","name":"","property":"count","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":160,"wires":[["74c9bae3.de5574"],["7eed3f80.e2183"]]},{"id":"4078384e.73ab28","type":"timed-counter","z":"8a0a444f.751b78","name":"Counter","timelimit":"1","timeunit":"1000","withhold":false,"fixedtimeout":false,"pertopic":false,"x":455,"y":200,"wires":[["969d4811.f8f118"]],"l":false},{"id":"969d4811.f8f118","type":"switch","z":"8a0a444f.751b78","name":"","property":"count","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":200,"wires":[["74c9bae3.de5574"],["7eed3f80.e2183"]]},{"id":"f3a1664a.955918","type":"timed-counter","z":"8a0a444f.751b78","name":"Counter","timelimit":"1","timeunit":"1000","withhold":false,"fixedtimeout":false,"pertopic":false,"x":455,"y":240,"wires":[["79977439.dd3a0c"]],"l":false},{"id":"79977439.dd3a0c","type":"switch","z":"8a0a444f.751b78","name":"","property":"count","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":240,"wires":[["80f72754.dc8e98"],["b2c87781.44daa8"]]},{"id":"6075b1d5.27579","type":"timed-counter","z":"8a0a444f.751b78","name":"Counter","timelimit":"1","timeunit":"1000","withhold":false,"fixedtimeout":false,"pertopic":false,"x":455,"y":280,"wires":[["22b0b077.82423"]],"l":false},{"id":"22b0b077.82423","type":"switch","z":"8a0a444f.751b78","name":"","property":"count","propertyType":"msg","rules":[{"t":"gt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":280,"wires":[["80f72754.dc8e98"],["b2c87781.44daa8"]]},{"id":"a1ac3c46.48e97","type":"comment","z":"d47f9ae6.2bf798","name":"Personalizar VAPRI (Aquí lista de colores)","info":"https://htmlcolorcodes.com/es/nombres-de-los-colores/","x":280,"y":820,"wires":[]},{"id":"6fe84c49.7d6e34","type":"ui_template","z":"d47f9ae6.2bf798","group":"aaad0e65.b3469","name":"Color de Tema (Control)","order":1,"width":0,"height":0,"format":"<style>\nmd-toolbar#toolbar{\n    background-color: var(--main-color);\n}\n\nbody.nr-dashboard-theme md-content {\n    color: var(--main-color);\n}\nbody.nr-dashboard-theme md-sidenav {\n    color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-button .md-button {\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template .md-button{\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template .md-button:disabled {\n    color: grey;\n}\n.nr-dashboard-theme .nr-dashboard-slider .md-thumb:after {\n    background-color: var(--main-color);\n    border-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-slider .md-track-fill {\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template ::-webkit-scrollbar {\n    background-color: #666666;\n}\n.nr-dashboard-theme .nr-dashboard-template ::-webkit-scrollbar-thumb {\n    background-color: var(--main-color);\n}\n</style>\n\n<script>\n(function($scope) {\n    \n$scope.$watch('msg.payload', function() {\n    console.log($scope.msg.payload);\n    var html = document.getElementsByTagName('html')[0];\n    html.style.setProperty(\"--main-color\", $scope.msg.payload);\n});\n})(scope);\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":470,"y":880,"wires":[["677fc407.0b25ec"]]},{"id":"c301321a.c7492","type":"inject","z":"d47f9ae6.2bf798","name":"Color del VAPRI","topic":"","payload":"DARKSLATEGRAY","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":220,"y":960,"wires":[["1280214f.7d180f"]]},{"id":"76c685b4.e894bc","type":"inject","z":"d47f9ae6.2bf798","name":"","topic":"","payload":"dashColor","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":"0.2","x":230,"y":880,"wires":[["6fe84c49.7d6e34"]]},{"id":"1280214f.7d180f","type":"change","z":"d47f9ae6.2bf798","name":"set global.dashColor","rules":[{"t":"set","p":"dashColor","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":920,"wires":[[]]},{"id":"677fc407.0b25ec","type":"ui_template","z":"d47f9ae6.2bf798","group":"d0600652.9f6778","name":"Color de Tema (Autonomo)","order":0,"width":0,"height":0,"format":"<style>\nmd-toolbar#toolbar{\n    background-color: var(--main-color);\n}\n\nbody.nr-dashboard-theme md-content {\n    color: var(--main-color);\n}\nbody.nr-dashboard-theme md-sidenav {\n    color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-button .md-button {\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template .md-button{\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template .md-button:disabled {\n    color: grey;\n}\n.nr-dashboard-theme .nr-dashboard-slider .md-thumb:after {\n    background-color: var(--main-color);\n    border-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-slider .md-track-fill {\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template ::-webkit-scrollbar {\n    background-color: #666666;\n}\n.nr-dashboard-theme .nr-dashboard-template ::-webkit-scrollbar-thumb {\n    background-color: var(--main-color);\n}\n</style>\n\n<script>\n(function($scope) {\n    \n$scope.$watch('msg.payload', function() {\n    console.log($scope.msg.payload);\n    var html = document.getElementsByTagName('html')[0];\n    html.style.setProperty(\"--main-color\", $scope.msg.payload);\n});\n})(scope);\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":720,"y":880,"wires":[["59f75258.b7248c"]]},{"id":"59f75258.b7248c","type":"ui_template","z":"d47f9ae6.2bf798","group":"6f7c3b98.411e14","name":"Color de Tema (Sistema)","order":0,"width":0,"height":0,"format":"<style>\nmd-toolbar#toolbar{\n    background-color: var(--main-color);\n}\n\nbody.nr-dashboard-theme md-content {\n    color: var(--main-color);\n}\nbody.nr-dashboard-theme md-sidenav {\n    color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-button .md-button {\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template .md-button{\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template .md-button:disabled {\n    color: grey;\n}\n.nr-dashboard-theme .nr-dashboard-slider .md-thumb:after {\n    background-color: var(--main-color);\n    border-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-slider .md-track-fill {\n    background-color: var(--main-color);\n}\n.nr-dashboard-theme .nr-dashboard-template ::-webkit-scrollbar {\n    background-color: #666666;\n}\n.nr-dashboard-theme .nr-dashboard-template ::-webkit-scrollbar-thumb {\n    background-color: var(--main-color);\n}\n</style>\n\n<script>\n(function($scope) {\n    \n$scope.$watch('msg.payload', function() {\n    console.log($scope.msg.payload);\n    var html = document.getElementsByTagName('html')[0];\n    html.style.setProperty(\"--main-color\", $scope.msg.payload);\n});\n})(scope);\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":730,"y":920,"wires":[[]]},{"id":"fb952c45.a8469","type":"change","z":"d47f9ae6.2bf798","name":"set global.vapriName","rules":[{"t":"set","p":"vapriName","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":1000,"wires":[["f17f6f9a.72fec"]]},{"id":"c587b447.cbdec8","type":"function","z":"2ce33584.a2bf7a","name":"Add name","func":"var text = msg.payload;\nvar name = global.get('vapriName')\nmsg.payload= name + ': '+ text \nreturn msg;","outputs":1,"noerr":0,"x":830,"y":180,"wires":[["c28a18b7.096d78"]]},{"id":"efec97dc.3ca2d8","type":"link out","z":"2ce33584.a2bf7a","name":"google-home-chat","links":["d9986d05.dcb8d"],"x":795,"y":220,"wires":[]},{"id":"44f88ed5.b60e2","type":"ui_audio","z":"2ce33584.a2bf7a","name":"","group":"aaad0e65.b3469","voice":"es-ES","always":true,"x":780,"y":300,"wires":[]},{"id":"94f72722.53a738","type":"change","z":"8a0a444f.751b78","name":"say ready","rules":[{"t":"set","p":"payload","pt":"msg","to":"¡Misil listo!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1740,"y":180,"wires":[["a221c6ca.3b2688"]]},{"id":"2c5f756e.aca10a","type":"change","z":"8a0a444f.751b78","name":"say ready","rules":[{"t":"set","p":"payload","pt":"msg","to":"¡Bolt listo!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1740,"y":440,"wires":[["6a14ea9b.b1b054"]]},{"id":"93f178ae.6daa68","type":"mqtt out","z":"8acaa1db.06f6a","name":"","topic":"","qos":"2","retain":"true","broker":"8714eca8.27de2","x":1050,"y":320,"wires":[]},{"id":"3908f55c.ef9c4a","type":"link in","z":"8acaa1db.06f6a","name":"to-mqtt-Powers-BOLT","links":["385957e6.54a128","f7d9c76.996e838"],"x":515,"y":320,"wires":[["66d1d6b9.489fd8"]]},{"id":"762f0a96.2282b4","type":"link out","z":"8acaa1db.06f6a","name":"from-mqtt-Powers-BOLT","links":["63b2f46a.d1687c"],"x":1095,"y":200,"wires":[]},{"id":"2682cfe1.b626","type":"comment","z":"8acaa1db.06f6a","name":"Chat","info":"","x":110,"y":160,"wires":[]},{"id":"3746bfa7.410bc","type":"comment","z":"8acaa1db.06f6a","name":"Poderes","info":"","x":560,"y":160,"wires":[]},{"id":"d545e765.cd6d98","type":"switch","z":"8a0a444f.751b78","name":"Misil enable","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1430,"y":120,"wires":[["aeaf1499.e70e68"],["7a4b080.14014f8"]]},{"id":"238f4055.1418a","type":"switch","z":"8a0a444f.751b78","name":"Bolt enable","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1430,"y":380,"wires":[["c07389f2.b32988"],["3f03139d.7aa4fc"]]},{"id":"4a45c971.63c418","type":"mqtt out","z":"8acaa1db.06f6a","name":"","topic":"","qos":"2","retain":"true","broker":"8714eca8.27de2","x":1050,"y":380,"wires":[]},{"id":"117108e2.ec3277","type":"link in","z":"8acaa1db.06f6a","name":"to-mqtt-Powers-MISIL","links":["47541ebb.81e56","7d8b1c6f.7fecd4"],"x":515,"y":380,"wires":[["fee6c9c9.98f108"]]},{"id":"615399aa.c94dd8","type":"link out","z":"8acaa1db.06f6a","name":"from-mqtt-Powers-MISIL","links":["62918225.24aa0c"],"x":1095,"y":260,"wires":[]},{"id":"47541ebb.81e56","type":"link out","z":"8a0a444f.751b78","name":"","links":["117108e2.ec3277"],"x":2455,"y":100,"wires":[]},{"id":"9950d1c6.d1918","type":"debug","z":"8acaa1db.06f6a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1210,"y":220,"wires":[]},{"id":"3aac1d14.cf2ae2","type":"switch","z":"8a0a444f.751b78","name":"Enable Filter","property":"enableRocket","propertyType":"global","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2150,"y":180,"wires":[["96cea721.0f5618"],[]]},{"id":"32be4c2.b8315b4","type":"switch","z":"8a0a444f.751b78","name":"Enable Filter","property":"enableBolt","propertyType":"global","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2110,"y":440,"wires":[["c803cace.80dd18"],[]]},{"id":"85ab1a91.89c458","type":"change","z":"8a7ddc8.106792","name":"","rules":[{"t":"set","p":"link","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":220,"wires":[[]]},{"id":"35d5a2cd.ff789e","type":"switch","z":"8a7ddc8.106792","name":"","property":"link","propertyType":"global","rules":[{"t":"null"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":180,"wires":[["51b8cd47.94c454"],["8e59cde7.d01dc"]]},{"id":"76c43823.1fe528","type":"function","z":"8a7ddc8.106792","name":"Formato ui existente","func":"var text = global.get('link');\nmsg.payload='Tu acceso remoto ngrok es: '+ text + '/ui';\nreturn msg;","outputs":1,"noerr":0,"x":980,"y":260,"wires":[["2de91eae.2a37b2"]]},{"id":"8e59cde7.d01dc","type":"switch","z":"8a7ddc8.106792","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":260,"wires":[["51b8cd47.94c454","525106ea.22b368"],["76c43823.1fe528"]]},{"id":"849186a9.2fd1a8","type":"comment","z":"8acaa1db.06f6a","name":"Canal Conteo","info":"","x":130,"y":360,"wires":[]},{"id":"2d507d66.c500c2","type":"mqtt in","z":"8acaa1db.06f6a","name":"","topic":"/vapris/staff/conteo","qos":"2","datatype":"auto","broker":"8714eca8.27de2","x":150,"y":420,"wires":[["40fdf988.086348","57327f1d.badf"]]},{"id":"40fdf988.086348","type":"link out","z":"8acaa1db.06f6a","name":"conteo-mqtt","links":["f796f23b.8b1df","d0851abd.cda2f8"],"x":275,"y":420,"wires":[]},{"id":"525106ea.22b368","type":"ngrok","z":"8a7ddc8.106792","port":"22","creds":"a11bd592.023a08","region":"us","proto":"tcp","subdomain":"","name":"","auth":"","x":530,"y":320,"wires":[["2de91eae.2a37b2"]]},{"id":"70226068.08573","type":"change","z":"28e94e1a.327fa2","name":"ssh","rules":[{"t":"set","p":"topic","pt":"msg","to":"ssh","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":200,"wires":[["7909f21a.35dbbc"]]},{"id":"67f3662a.ba1948","type":"change","z":"8a7ddc8.106792","name":"on","rules":[{"t":"set","p":"payload","pt":"msg","to":"on","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":320,"wires":[["525106ea.22b368"]]},{"id":"377d5e3e.25cbe2","type":"qrDecode","z":"df558687.1df838","name":"","input":"payload","output":"payload","inputType":"msg","x":170,"y":600,"wires":[["5fe5bfe.67f764"]]},{"id":"5fe5bfe.67f764","type":"switch","z":"df558687.1df838","name":"QR Codes","property":"payload.text","propertyType":"msg","rules":[{"t":"empty"},{"t":"eq","v":"PW","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":330,"y":600,"wires":[["210957c2.f73ae8"],["4ce59c22.a5e9b4"],["f30878d8.a6fc48"]]},{"id":"26d1f4d8.50726c","type":"link out","z":"df558687.1df838","name":"fromQR_Bolt","links":["63b2f46a.d1687c"],"x":875,"y":640,"wires":[]},{"id":"4ce59c22.a5e9b4","type":"change","z":"df558687.1df838","name":"set 1","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":660,"wires":[["8d1fd3af.a9efe"]]},{"id":"cb21fc3.b17fc","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"\"F00\"","payloadType":"env","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":920,"wires":[["72fb008c.b8a7d"]]},{"id":"72fb008c.b8a7d","type":"debug","z":"2acc8810.81c7a8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":410,"y":920,"wires":[]},{"id":"55235457.7fc4ec","type":"comment","z":"2acc8810.81c7a8","name":"enviromental Variables - Telegram Token","info":"","x":260,"y":860,"wires":[]},{"id":"fee6c9c9.98f108","type":"function","z":"8acaa1db.06f6a","name":"/vapris/VAPRINAME/powers/misil","func":"var vapriNameCaps = global.get('vapriName')\nvar vapriName = vapriNameCaps.toLowerCase();\n\nmsg.topic = '/vapris/'+ vapriName +'/powers/misil'\n\nreturn msg;","outputs":1,"noerr":0,"x":700,"y":380,"wires":[["4a45c971.63c418"]]},{"id":"66d1d6b9.489fd8","type":"function","z":"8acaa1db.06f6a","name":"/vapris/VAPRINAME/powers/bolt","func":"var vapriNameCaps = global.get('vapriName')\nvar vapriName = vapriNameCaps.toLowerCase();\n\nmsg.topic = '/vapris/'+ vapriName +'/powers/bolt'\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":320,"wires":[["93f178ae.6daa68"]]},{"id":"ffc7e41b.becc28","type":"inject","z":"8acaa1db.06f6a","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":570,"y":260,"wires":[["a0ef741f.18a2e8"]]},{"id":"a0ef741f.18a2e8","type":"function","z":"8acaa1db.06f6a","name":"/vapris/VAPRINAME/powers/misil","func":"var vapriNameCaps = global.get('vapriName')\nvar vapriName = vapriNameCaps.toLowerCase();\n\nmsg.topic = '/vapris/'+ vapriName +'/powers/misil'\n\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":260,"wires":[["76e3215b.c8f"]]},{"id":"1bfc543b.6564ac","type":"inject","z":"8acaa1db.06f6a","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":570,"y":200,"wires":[["9bb603b5.6a42e"]]},{"id":"9bb603b5.6a42e","type":"function","z":"8acaa1db.06f6a","name":"/vapris/VAPRINAME/powers/bolt","func":"var vapriNameCaps = global.get('vapriName')\nvar vapriName = vapriNameCaps.toLowerCase();\n\nmsg.topic = '/vapris/'+ vapriName +'/powers/bolt'\n\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":200,"wires":[["f2122f88.37f66"]]},{"id":"9a8ced22.26a49","type":"function","z":"8acaa1db.06f6a","name":"/vapris/VAPRINAME/chat","func":"var vapriNameCaps = global.get('vapriName')\nvar vapriName = vapriNameCaps.toLowerCase();\n\nmsg.topic = '/vapris/'+ vapriName +'/chat'\n\nreturn msg;","outputs":1,"noerr":0,"x":230,"y":200,"wires":[["e9dbbf7d.db2f5"]]},{"id":"d7abe49e.08ca78","type":"comment","z":"8acaa1db.06f6a","name":"¿Recibes mensajes duplicados? Prueba borrar y vuelve a arrastrar los mqtt in dinámicos problemáticos","info":"Es una funcionalidad no tan cool de los nodos, se pueden suscribir más de una vez al mismo tópico","x":410,"y":80,"wires":[]},{"id":"7ec3b2a8.d788ec","type":"switch","z":"2ce33584.a2bf7a","name":"\"empty\" filter","property":"payload","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":670,"y":180,"wires":[["efec97dc.3ca2d8","c587b447.cbdec8"]]},{"id":"f2122f88.37f66","type":"digitaloak-mqtt-in","z":"8acaa1db.06f6a","name":"","qos":"2","datatype":"auto","unsubscribe-after-first-msg-recv":false,"broker":"8714eca8.27de2","x":990,"y":200,"wires":[["762f0a96.2282b4","9950d1c6.d1918"]]},{"id":"76e3215b.c8f","type":"digitaloak-mqtt-in","z":"8acaa1db.06f6a","name":"","qos":"2","datatype":"auto","unsubscribe-after-first-msg-recv":false,"broker":"8714eca8.27de2","x":1000,"y":260,"wires":[["615399aa.c94dd8","9950d1c6.d1918"]]},{"id":"ef27a480.d19b78","type":"mqtt in","z":"8acaa1db.06f6a","name":"","topic":"/vapris/+/powers/misil","qos":"2","datatype":"auto","broker":"8714eca8.27de2","x":600,"y":560,"wires":[["8b9b0885.f83228"]]},{"id":"8b9b0885.f83228","type":"switch","z":"8acaa1db.06f6a","name":"si es este VAPRI...","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"vapriName","vt":"global"}],"checkall":"true","repair":false,"outputs":1,"x":870,"y":560,"wires":[["e7210269.802de"]]},{"id":"df4a09e2.8802c8","type":"inject","z":"8acaa1db.06f6a","name":"","topic":"","payload":"vapriName","payloadType":"global","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":600,"y":440,"wires":[["fee6c9c9.98f108"]]},{"id":"e7210269.802de","type":"change","z":"8acaa1db.06f6a","name":"Find quién disparó","rules":[{"t":"change","p":"topic","pt":"msg","from":"/vapris/","fromt":"str","to":"","tot":"str"},{"t":"change","p":"topic","pt":"msg","from":"/powers/misil","fromt":"str","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":620,"wires":[["b5efd1ee.1bb36"]]},{"id":"b5efd1ee.1bb36","type":"function","z":"8acaa1db.06f6a","name":"quiénAtacó","func":"var vapriNameCaps = msg.topic\nvar vapriName = vapriNameCaps.toUpperCase();\n\nmsg.payload = '¡'+ vapriName + ' te disparó!'\n\nreturn msg;","outputs":1,"noerr":0,"x":870,"y":620,"wires":[["87d5455e.e393b8","7f0e608a.29457"]]},{"id":"87d5455e.e393b8","type":"link out","z":"8acaa1db.06f6a","name":"fromQuienAtacó","links":["da865c87.d57de","6ce30675.351238"],"x":1035,"y":600,"wires":[]},{"id":"a221c6ca.3b2688","type":"link out","z":"8a0a444f.751b78","name":"readyMisil","links":["da865c87.d57de","6ce30675.351238"],"x":1835,"y":180,"wires":[]},{"id":"6a14ea9b.b1b054","type":"link out","z":"8a0a444f.751b78","name":"readyMisil","links":["da865c87.d57de","6ce30675.351238"],"x":1835,"y":440,"wires":[]},{"id":"57327f1d.badf","type":"debug","z":"8acaa1db.06f6a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":150,"y":480,"wires":[]},{"id":"70f35242.be8cdc","type":"change","z":"2ce33584.a2bf7a","name":"vaciar","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":200,"wires":[["c24ea7ba.190e18"]]},{"id":"ebaa10f.ebcdbf","type":"telegrambot-command","z":"28e94e1a.327fa2","name":"/shutdown","bot":"3ad0e292.3924ce","command":"/shutdown","commandType":"str","commandCase":false,"x":120,"y":360,"wires":[["cdf0abde.c1eb28"]]},{"id":"9356fa74.5fdb88","type":"exec","z":"c7c81a64.db1438","command":"sudo halt","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":440,"y":200,"wires":[[],[],[]]},{"id":"6a520e15.ac8b1","type":"link out","z":"d47f9ae6.2bf798","name":"from-ui-reiniciar","links":["cb98fd1d.23657"],"x":1135,"y":140,"wires":[]},{"id":"e65e5b3.c4713a8","type":"ui_toast","z":"d47f9ae6.2bf798","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"OK","cancel":"","raw":false,"topic":"","name":"","x":990,"y":140,"wires":[["6a520e15.ac8b1"]]},{"id":"91bf57d9.5736c8","type":"link in","z":"c7c81a64.db1438","name":"sistema-apagar","links":["b30fea42.8f09c8","cdf0abde.c1eb28"],"x":275,"y":180,"wires":[["9356fa74.5fdb88"]]},{"id":"cdf0abde.c1eb28","type":"link out","z":"28e94e1a.327fa2","name":"/shutdown","links":["91bf57d9.5736c8"],"x":295,"y":360,"wires":[]},{"id":"7d43c06e.e4e14","type":"comment","z":"8acaa1db.06f6a","name":"Fuimos atacados","info":"","x":580,"y":520,"wires":[]},{"id":"c150432d.643fd","type":"change","z":"8a0a444f.751b78","name":"kill motores!","rules":[{"t":"set","p":"motores","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1530,"y":700,"wires":[["48768553.ca6bcc","f37ac82d.0122b8"]]},{"id":"48768553.ca6bcc","type":"trigger","z":"8a0a444f.751b78","op1":"","op2":"0","op1type":"nul","op2type":"str","duration":"5","extend":false,"units":"s","reset":"","bytopic":"all","name":"5s","x":1670,"y":700,"wires":[["61c222d5.dbed8c"]]},{"id":"7f0e608a.29457","type":"link out","z":"8acaa1db.06f6a","name":"fromRecibimosMisil","links":["971e53f5.e7f3b"],"x":1035,"y":640,"wires":[]},{"id":"971e53f5.e7f3b","type":"link in","z":"8a0a444f.751b78","name":"toMisilStop","links":["7f0e608a.29457"],"x":1335,"y":660,"wires":[["e501a0a5.cd69e"]]},{"id":"fd3094c3.a3c428","type":"comment","z":"8a0a444f.751b78","name":"Bajo Ataque","info":"","x":1390,"y":600,"wires":[]},{"id":"61c222d5.dbed8c","type":"change","z":"8a0a444f.751b78","name":"reset global.motores","rules":[{"t":"set","p":"motores","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1840,"y":700,"wires":[[]]},{"id":"e97f7c5f.4ba4e","type":"change","z":"8a0a444f.751b78","name":"slow down!","rules":[{"t":"set","p":"DefaultVelMax","pt":"flow","to":"velMax","tot":"global"},{"t":"set","p":"velMax","pt":"global","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1530,"y":660,"wires":[["82218a9.d42e378","f37ac82d.0122b8","c150432d.643fd"]]},{"id":"82218a9.d42e378","type":"trigger","z":"8a0a444f.751b78","op1":"","op2":"0","op1type":"nul","op2type":"str","duration":"5","extend":false,"units":"s","reset":"","bytopic":"all","name":"5s","x":1670,"y":660,"wires":[["27e1bb8e.517de4"]]},{"id":"27e1bb8e.517de4","type":"change","z":"8a0a444f.751b78","name":"reset velMax","rules":[{"t":"set","p":"velMax","pt":"global","to":"DefaultVelMax","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":1870,"y":660,"wires":[["f37ac82d.0122b8"]]},{"id":"f37ac82d.0122b8","type":"link out","z":"8a0a444f.751b78","name":"","links":["8db34a58.037c88"],"x":2015,"y":740,"wires":[]},{"id":"1b582ce.76469d3","type":"link in","z":"8a0a444f.751b78","name":"toBoltSlow","links":["625550db.4adcf"],"x":1335,"y":800,"wires":[["fca6949.ba01368"]]},{"id":"d0491e17.37ab3","type":"change","z":"8a0a444f.751b78","name":"reset velMax","rules":[{"t":"set","p":"velMax","pt":"global","to":"DefaultVelMax","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":1850,"y":800,"wires":[["f37ac82d.0122b8"]]},{"id":"f27b0306.f9b32","type":"trigger","z":"8a0a444f.751b78","op1":"","op2":"0","op1type":"nul","op2type":"str","duration":"5","extend":false,"units":"s","reset":"","bytopic":"all","name":"5s","x":1650,"y":800,"wires":[["d0491e17.37ab3"]]},{"id":"29b18ae2.4753f6","type":"change","z":"8a0a444f.751b78","name":"slow down!","rules":[{"t":"set","p":"DefaultVelMax","pt":"flow","to":"velMax","tot":"global"},{"t":"set","p":"velMax","pt":"global","to":"60","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1510,"y":800,"wires":[["f27b0306.f9b32","f37ac82d.0122b8"]]},{"id":"2b365f23.eae9d","type":"mqtt in","z":"8acaa1db.06f6a","name":"","topic":"/vapris/+/powers/bolt","qos":"2","datatype":"auto","broker":"8714eca8.27de2","x":590,"y":680,"wires":[["f5b9e8bc.7ecf18"]]},{"id":"7a0e96cc.417ca8","type":"change","z":"8acaa1db.06f6a","name":"Find quién disparó","rules":[{"t":"change","p":"topic","pt":"msg","from":"/vapris/","fromt":"str","to":"","tot":"str"},{"t":"change","p":"topic","pt":"msg","from":"/powers/bolt","fromt":"str","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":590,"y":740,"wires":[["7aeada5d.539304"]]},{"id":"5663d485.63f19c","type":"function","z":"8acaa1db.06f6a","name":"quiénAtacó","func":"var vapriName = msg.payload\n\nmsg.payload = '¡'+ vapriName + ' usó Bolt!'\n\nreturn msg;","outputs":1,"noerr":0,"x":1210,"y":760,"wires":[["59601aea.c13ce4","625550db.4adcf"]]},{"id":"59601aea.c13ce4","type":"link out","z":"8acaa1db.06f6a","name":"fromQuienBolteó","links":["da865c87.d57de","6ce30675.351238"],"x":1335,"y":720,"wires":[]},{"id":"625550db.4adcf","type":"link out","z":"8acaa1db.06f6a","name":"fromRecibimosBolt","links":["1b582ce.76469d3"],"x":1335,"y":760,"wires":[]},{"id":"f5b9e8bc.7ecf18","type":"switch","z":"8acaa1db.06f6a","name":"filtrar BOLT","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"bolt","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":890,"y":680,"wires":[["7a0e96cc.417ca8","de09579d.e074f8"]]},{"id":"de09579d.e074f8","type":"debug","z":"8acaa1db.06f6a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1190,"y":660,"wires":[]},{"id":"c803cace.80dd18","type":"change","z":"8a0a444f.751b78","name":"say bolt","rules":[{"t":"set","p":"payload","pt":"msg","to":"bolt","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":440,"wires":[["f7d9c76.996e838","ecd0fda.9a665"]]},{"id":"f7d9c76.996e838","type":"link out","z":"8a0a444f.751b78","name":"hicimosBolt","links":["3908f55c.ef9c4a"],"x":2395,"y":440,"wires":[]},{"id":"fc5e54c1.61ee08","type":"switch","z":"8acaa1db.06f6a","name":"si es este VAPRI...","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"vapriName","vt":"global"},{"t":"neq","v":"vapriName","vt":"global"}],"checkall":"true","repair":false,"outputs":2,"x":970,"y":740,"wires":[["5feda283.180c5c"],["5663d485.63f19c"]]},{"id":"5feda283.180c5c","type":"function","z":"8acaa1db.06f6a","name":"nosotrosAtacamos","func":"msg.payload = '¡Usaste Bolt!'\n\nreturn msg;","outputs":1,"noerr":0,"x":1190,"y":720,"wires":[["59601aea.c13ce4"]]},{"id":"fca6949.ba01368","type":"delay","z":"8a0a444f.751b78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1395,"y":800,"wires":[["29b18ae2.4753f6"]],"l":false},{"id":"e501a0a5.cd69e","type":"delay","z":"8a0a444f.751b78","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1395,"y":660,"wires":[["e97f7c5f.4ba4e"]],"l":false},{"id":"3ab22f4d.48f4f","type":"comment","z":"8a0a444f.751b78","name":"Uso ratelimit porque...","info":"Si recibes más ataques antes de los 5s hay errores con tu velocidad default, así puedes recibir más de un ataque y se acumulan, pero no hay errores","x":1420,"y":740,"wires":[]},{"id":"7aeada5d.539304","type":"function","z":"8acaa1db.06f6a","name":"upperCase","func":"var vapriNameCaps = msg.topic\nvar vapriName = vapriNameCaps.toUpperCase();\n\nmsg.payload = vapriName \n\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":740,"wires":[["fc5e54c1.61ee08"]]},{"id":"e24e8838.187778","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"SIGTERM","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":780,"wires":[["b6c5debd.3d4b3"]]},{"id":"b6c5debd.3d4b3","type":"change","z":"2acc8810.81c7a8","name":"","rules":[{"t":"set","p":"kill","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":780,"wires":[["5feb4cd2.771204"]]},{"id":"2b653b59.f609d4","type":"ui_switch","z":"8a0a444f.751b78","name":"","label":"Arranque automático","tooltip":"","group":"86fbfdda.0813b","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":260,"y":600,"wires":[["63ddfbcb.2aa854"]]},{"id":"63ddfbcb.2aa854","type":"switch","z":"8a0a444f.751b78","name":"","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":450,"y":600,"wires":[["1013f721.d4c119"],["1d92eb13.daccc5"]]},{"id":"1013f721.d4c119","type":"change","z":"8a0a444f.751b78","name":"motores on","rules":[{"t":"set","p":"motores","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"llave","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":580,"wires":[["5b707dfa.6f2f14"]]},{"id":"1d92eb13.daccc5","type":"change","z":"8a0a444f.751b78","name":"motores off","rules":[{"t":"set","p":"motores","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"llave","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"auto","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"radar","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":620,"wires":[["75617e3a.4a90e","5b707dfa.6f2f14"]]},{"id":"87dca041.c8536","type":"change","z":"8a0a444f.751b78","name":"Motores On","rules":[{"t":"set","p":"motores","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":380,"wires":[["5d87f446.5825fc"]]},{"id":"b5392880.59b248","type":"change","z":"8a0a444f.751b78","name":"Motores Off","rules":[{"t":"set","p":"motores","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":420,"wires":[["d10ead93.65bb1"]]},{"id":"66e2811b.72bc4","type":"comment","z":"8a0a444f.751b78","name":"Scan","info":"","x":1370,"y":900,"wires":[]},{"id":"aad996ab.49ff08","type":"ui_template","z":"8a0a444f.751b78","group":"aaad0e65.b3469","name":"Centro","order":8,"width":2,"height":1,"format":"   \n<div class=\"momentarycen vibrate filled touched bigfont rounded\" style={{(msg.payload)}}>\n<center>\n<md-button class=\"filled touched bigfont rounded\" style={{(msg.payload)}}> \n    Scan<br/><i class=\"fa fa-qrcode fa-1x\" aria-hidden=\"true\"></i>\n</md-button>\n</center>\n</div>\n\n<script>\n(function($scope) {\n$('.momentarycen').on('touchstart mousedown', function(e) {\n    e.preventDefault(); //prevent default behavior\n    navigator.vibrate(30);\n    $scope.send({\"payload\": 1});\n});\n\n$('.momentarycen').on('touchend mouseup', function(e) {\n    e.preventDefault(); //prevent default behavior\n    //$scope.send({\"payload\": 0});\n});\n})(scope);\n</script>\n\n","storeOutMessages":false,"fwdInMessages":false,"templateScope":"local","x":1730,"y":960,"wires":[["732187df.5add98","660ddc40.59cfa4"]]},{"id":"d30b988a.5691e8","type":"change","z":"8a0a444f.751b78","name":"Color Rojo","rules":[{"t":"set","p":"payload","pt":"msg","to":"background-color:#c0392b","tot":"str"},{"t":"set","p":"colorCentro","pt":"global","to":"background-color:#c0392b","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1570,"y":960,"wires":[["aad996ab.49ff08"]]},{"id":"660ddc40.59cfa4","type":"change","z":"8a0a444f.751b78","name":"Color Azul","rules":[{"t":"set","p":"payload","pt":"msg","to":"background-color:#34495e","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1730,"y":1000,"wires":[["fbe535a7.95dfb8","aad996ab.49ff08"]]},{"id":"811f8e68.b200f","type":"inject","z":"8a0a444f.751b78","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"0","x":1410,"y":960,"wires":[["d30b988a.5691e8"]]},{"id":"de2d12f4.ab514","type":"ui_toast","z":"d47f9ae6.2bf798","position":"top left","displayTime":"3","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"topic":"","name":"pop-up","x":1080,"y":280,"wires":[]},{"id":"d0851abd.cda2f8","type":"link in","z":"d47f9ae6.2bf798","name":"conteo-telefono-PopUp","links":["40fdf988.086348"],"x":775,"y":260,"wires":[["8636cd11.b74da"]]},{"id":"8636cd11.b74da","type":"change","z":"d47f9ae6.2bf798","name":"Cuenta Topic","rules":[{"t":"set","p":"topic","pt":"msg","to":"Cuenta regresiva","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":890,"y":260,"wires":[["de2d12f4.ab514"]]},{"id":"6ce30675.351238","type":"link in","z":"d47f9ae6.2bf798","name":"toPoderesPopUp","links":["87d5455e.e393b8","a221c6ca.3b2688","6a14ea9b.b1b054","59601aea.c13ce4","decf66d3.98c908","9b61dd23.68bef","cd4ad8a1.5ce8c8","1ab85c04.c8bcb4"],"x":775,"y":300,"wires":[["44ebe35d.37ceac"]]},{"id":"44ebe35d.37ceac","type":"change","z":"d47f9ae6.2bf798","name":"Poderes Topic","rules":[{"t":"set","p":"topic","pt":"msg","to":"Poderes","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":300,"wires":[["de2d12f4.ab514"]]},{"id":"c4dee5d9.e74ad8","type":"comment","z":"d47f9ae6.2bf798","name":"Pop-ups","info":"","x":820,"y":220,"wires":[]},{"id":"da5125a4.bed158","type":"link in","z":"df558687.1df838","name":"ToScanPhoto","links":["732187df.5add98"],"x":115,"y":320,"wires":[["a689513a.691ad"]]},{"id":"732187df.5add98","type":"link out","z":"8a0a444f.751b78","name":"fromScanButton","links":["da5125a4.bed158"],"x":1860,"y":960,"wires":[]},{"id":"fbe535a7.95dfb8","type":"delay","z":"8a0a444f.751b78","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1740,"y":1040,"wires":[["d30b988a.5691e8"]]},{"id":"210957c2.f73ae8","type":"change","z":"df558687.1df838","name":"Escaneo fallido.","rules":[{"t":"set","p":"payload","pt":"msg","to":"Falló el escaneo","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":620,"wires":[["decf66d3.98c908"]]},{"id":"decf66d3.98c908","type":"link out","z":"df558687.1df838","name":"fromFailedScan","links":["6ce30675.351238"],"x":655,"y":620,"wires":[]},{"id":"a689513a.691ad","type":"change","z":"df558687.1df838","name":"","rules":[{"t":"set","p":"scan","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":320,"wires":[["ef684536.39a018"]]},{"id":"1b3021fd.65ec9e","type":"switch","z":"df558687.1df838","name":"check global.scan","property":"scan","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":510,"y":360,"wires":[["377d5e3e.25cbe2"]]},{"id":"ef684536.39a018","type":"delay","z":"df558687.1df838","name":"","pauseType":"delay","timeout":"0.39","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":270,"y":360,"wires":[["260fde58.e6afb2"]]},{"id":"260fde58.e6afb2","type":"change","z":"df558687.1df838","name":"","rules":[{"t":"set","p":"scan","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":400,"wires":[[]]},{"id":"82ed6453.522268","type":"link out","z":"df558687.1df838","name":"fromQR_Misil","links":["62918225.24aa0c"],"x":875,"y":680,"wires":[]},{"id":"8d1fd3af.a9efe","type":"random","z":"df558687.1df838","name":"","low":"1","high":"5","inte":"true","property":"payload.random","x":640,"y":660,"wires":[["ddc19471.81a688"]]},{"id":"ddc19471.81a688","type":"switch","z":"df558687.1df838","name":"","property":"payload.random","propertyType":"msg","rules":[{"t":"gt","v":"1","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":660,"wires":[["26d1f4d8.50726c"],["82ed6453.522268"]]},{"id":"f30878d8.a6fc48","type":"change","z":"df558687.1df838","name":"VAPRINAME to OBJETIVO_DISPARO","rules":[{"t":"set","p":"OBJETIVO_DISPARO","pt":"global","to":"payload.text","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":580,"wires":[["15921e82.7532b1"]]},{"id":"15921e82.7532b1","type":"function","z":"df558687.1df838","name":"En la mira","func":"var name = global.get('OBJETIVO_DISPARO')\nmsg.payload = '¡' + name + ' en la mira por 10s!'\nreturn msg;","outputs":1,"noerr":0,"x":870,"y":580,"wires":[["5812eb7e.99c9c4","5847d9b1.1b2d28"]]},{"id":"82401fce.7ee01","type":"ui_toast","z":"df558687.1df838","position":"top left","displayTime":"10","highlight":"","sendall":true,"outputs":0,"ok":"OK","cancel":"","raw":false,"topic":"","name":"pop-up 10s","x":1210,"y":620,"wires":[]},{"id":"5812eb7e.99c9c4","type":"change","z":"df558687.1df838","name":"Poderes Topic","rules":[{"t":"set","p":"topic","pt":"msg","to":"Poderes","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1040,"y":620,"wires":[["82401fce.7ee01"]]},{"id":"5847d9b1.1b2d28","type":"delay","z":"df558687.1df838","name":"delay 10s","pauseType":"delayv","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1020,"y":580,"wires":[["7d646122.e4a6"]]},{"id":"bcccb73b.9b2c08","type":"function","z":"df558687.1df838","name":"Escapó","func":"var name = global.get('OBJETIVO_DISPARO')\nmsg.payload = name + ' ha escapado'\nreturn msg;","outputs":1,"noerr":0,"x":1340,"y":580,"wires":[["cd4ad8a1.5ce8c8","a95ffa31.4b5568"]]},{"id":"cd4ad8a1.5ce8c8","type":"link out","z":"df558687.1df838","name":"fromObjetivoEscapo","links":["6ce30675.351238"],"x":1475,"y":580,"wires":[]},{"id":"7d646122.e4a6","type":"delay","z":"df558687.1df838","name":"","pauseType":"rate","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"3","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1180,"y":580,"wires":[["bcccb73b.9b2c08"]]},{"id":"afca6223.fbd72","type":"change","z":"8a0a444f.751b78","name":"VAPRINAME to disparo mqtt","rules":[{"t":"set","p":"payload","pt":"msg","to":"OBJETIVO_DISPARO","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":2560,"y":140,"wires":[["7d8b1c6f.7fecd4"]]},{"id":"3217a07a.2a4f8","type":"function","z":"8a0a444f.751b78","name":"Disparo Correcto","func":"var name = global.get('OBJETIVO_DISPARO')\nmsg.payload = '¡Le disparaste a ' + name + '!'\nreturn msg;","outputs":1,"noerr":0,"x":2530,"y":180,"wires":[["1ab85c04.c8bcb4"]]},{"id":"1ab85c04.c8bcb4","type":"link out","z":"8a0a444f.751b78","name":"fromMisilShot","links":["6ce30675.351238"],"x":2675,"y":200,"wires":[]},{"id":"96cea721.0f5618","type":"switch","z":"8a0a444f.751b78","name":"null filter","property":"OBJETIVO_DISPARO","propertyType":"global","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2300,"y":180,"wires":[["47541ebb.81e56","afca6223.fbd72","3217a07a.2a4f8"],["ac7b5076.fbf22"]]},{"id":"ac7b5076.fbf22","type":"function","z":"8a0a444f.751b78","name":"Disparo no Objetivo","func":"\nmsg.payload = 'No tienes a ningún objetivo fijado.'\nreturn msg;","outputs":1,"noerr":0,"x":2530,"y":220,"wires":[["1ab85c04.c8bcb4"]]},{"id":"7d8b1c6f.7fecd4","type":"link out","z":"8a0a444f.751b78","name":"fromDisparoconObjetivo","links":["117108e2.ec3277"],"x":2715,"y":140,"wires":[]},{"id":"8d22a2b.20cf36","type":"function","z":"2ce33584.a2bf7a","name":"a minusculas","func":"var cadena = msg.payload;\ncadena = cadena.toLowerCase();\nmsg.payload = cadena;\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":300,"wires":[["44f88ed5.b60e2"]]},{"id":"a95ffa31.4b5568","type":"change","z":"df558687.1df838","name":"clear En la mira","rules":[{"t":"set","p":"OBJETIVO_DISPARO","pt":"global","to":"null","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":1400,"y":620,"wires":[[]]},{"id":"21f29cc7.1f4074","type":"switch","z":"8a0a444f.751b78","name":"Enable Filter","property":"enableRocket","propertyType":"global","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1590,"y":240,"wires":[["5228c59c.12ceac"],["352aa22d.f1ff5e"]]},{"id":"44145718.0463c8","type":"inject","z":"8a0a444f.751b78","name":"","topic":"","payload":"","payloadType":"str","repeat":"1","crontab":"","once":true,"onceDelay":"1","x":1450,"y":240,"wires":[["21f29cc7.1f4074"]]},{"id":"9b16d9d0.701948","type":"inject","z":"8a0a444f.751b78","name":"","topic":"","payload":"","payloadType":"str","repeat":"1","crontab":"","once":true,"onceDelay":"1","x":1450,"y":500,"wires":[["91da22ec.1e31e"]]},{"id":"91da22ec.1e31e","type":"switch","z":"8a0a444f.751b78","name":"Enable Filter","property":"enableBolt","propertyType":"global","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1590,"y":500,"wires":[["d9cfaa4d.a99eb8"],["bd4d294c.932f28"]]},{"id":"352aa22d.f1ff5e","type":"change","z":"8a0a444f.751b78","name":"default style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#34495e","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-rocket fa-lg","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":260,"wires":[["852e1499.6d61a8"]]},{"id":"5228c59c.12ceac","type":"change","z":"8a0a444f.751b78","name":"enable style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#8e44ad","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-rocket fa-lg","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":220,"wires":[["852e1499.6d61a8"]]},{"id":"d9cfaa4d.a99eb8","type":"change","z":"8a0a444f.751b78","name":"enable style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#8e44ad","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-bolt fa-lg","tot":"str"},{"t":"set","p":"logoSmall","pt":"msg","to":"fa fa-bolt fa-sm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":480,"wires":[["ca62b602.498198"]]},{"id":"bd4d294c.932f28","type":"change","z":"8a0a444f.751b78","name":"default style","rules":[{"t":"set","p":"color","pt":"msg","to":"background-color:#34495e","tot":"str"},{"t":"set","p":"logo","pt":"msg","to":"fa fa-bolt fa-lg","tot":"str"},{"t":"set","p":"logoSmall","pt":"msg","to":"fa fa-bolt fa-sm","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":520,"wires":[["ca62b602.498198"]]},{"id":"ae1cf1d5.3ce3b","type":"link out","z":"8a0a444f.751b78","name":"fromBoltEfectoLuz","links":["b811fd0c.0a6aa"],"x":2675,"y":540,"wires":[]},{"id":"b7afc57f.fca4f8","type":"delay","z":"8a0a444f.751b78","name":"0.1s","pauseType":"delay","timeout":"250","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2190,"y":540,"wires":[["42c033b5.7eb0cc"]]},{"id":"ecd0fda.9a665","type":"change","z":"8a0a444f.751b78","d":true,"name":"1","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2190,"y":500,"wires":[["b7afc57f.fca4f8","ae1cf1d5.3ce3b"]]},{"id":"42c033b5.7eb0cc","type":"change","z":"8a0a444f.751b78","name":"0","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2350,"y":500,"wires":[["ae1cf1d5.3ce3b","53ac0781.f798c8"]]},{"id":"53ac0781.f798c8","type":"delay","z":"8a0a444f.751b78","name":"0.1s","pauseType":"delay","timeout":"250","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2350,"y":540,"wires":[["7ea4ce58.a1e1a"]]},{"id":"7ea4ce58.a1e1a","type":"change","z":"8a0a444f.751b78","name":"1","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2510,"y":500,"wires":[["ae1cf1d5.3ce3b","9407b772.8ac8a8"]]},{"id":"9407b772.8ac8a8","type":"delay","z":"8a0a444f.751b78","name":"0.1s","pauseType":"delay","timeout":"250","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2510,"y":540,"wires":[["e11f0617.96f588"]]},{"id":"e11f0617.96f588","type":"change","z":"8a0a444f.751b78","name":"0","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2650,"y":500,"wires":[["ae1cf1d5.3ce3b"]]},{"id":"ecf9fd33.d5f3c","type":"comment","z":"8acaa1db.06f6a","name":"Luz Inventoteca","info":"","x":140,"y":560,"wires":[]},{"id":"537d357d.a588ac","type":"mqtt out","z":"8acaa1db.06f6a","name":"","topic":"inventoteca/serverus/sala3/luz","qos":"2","retain":"true","broker":"8714eca8.27de2","x":250,"y":600,"wires":[]},{"id":"b811fd0c.0a6aa","type":"link in","z":"8acaa1db.06f6a","name":"toLuzMQTT","links":["ae1cf1d5.3ce3b"],"x":75,"y":600,"wires":[["537d357d.a588ac","69735fab.3e44c"]]},{"id":"69735fab.3e44c","type":"debug","z":"8acaa1db.06f6a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":290,"y":660,"wires":[]},{"id":"d9704ed6.016bd","type":"ui_ui_control","z":"d47f9ae6.2bf798","name":"","events":"change","x":1380,"y":720,"wires":[[]]},{"id":"46ba37e2.a95048","type":"function","z":"d47f9ae6.2bf798","name":"hide Funciones Avanzadas","func":"msg.payload = {\"group\": {\"hide\": [\"Control_Funciones_Avanzadas\"]}}\nreturn msg;","outputs":1,"noerr":0,"x":1320,"y":760,"wires":[["d9704ed6.016bd"]]},{"id":"3b4a6b49.c570a4","type":"function","z":"d47f9ae6.2bf798","name":"show Funciones Avanzadas","func":"msg.payload = {\"group\": {\"show\": [\"Control_Funciones_Avanzadas\"]}}\nreturn msg;","outputs":1,"noerr":0,"x":1320,"y":680,"wires":[["d9704ed6.016bd"]]},{"id":"42082080.ae7c2","type":"switch","z":"d47f9ae6.2bf798","name":"","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1130,"y":720,"wires":[["3b4a6b49.c570a4"],["46ba37e2.a95048"]]},{"id":"80190df3.36dbd","type":"ui_switch","z":"d47f9ae6.2bf798","name":"Modo Avanzado","label":"Habilida Modo Avanzado","tooltip":"","group":"e6f366f9.1e9da8","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":980,"y":720,"wires":[["42082080.ae7c2"]]},{"id":"d90b7c36.5b55a","type":"inject","z":"d47f9ae6.2bf798","name":"","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":true,"onceDelay":"0.1","x":830,"y":720,"wires":[["80190df3.36dbd"]]},{"id":"294e26e1.8fa90a","type":"comment","z":"d47f9ae6.2bf798","name":"Modo Experto","info":"","x":830,"y":640,"wires":[]},{"id":"2f4db144.f0477e","type":"ui_ui_control","z":"d47f9ae6.2bf798","name":"","events":"all","x":580,"y":680,"wires":[[]]},{"id":"c13693aa.0e491","type":"function","z":"d47f9ae6.2bf798","name":"Esconder Tabs","func":"msg.payload = {\"tabs\": {\"hide\": [\"Autónomo\", \"Sistema\"]}}\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":660,"wires":[["2f4db144.f0477e"]]},{"id":"871bcad3.3a2298","type":"inject","z":"d47f9ae6.2bf798","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":"0.5","x":190,"y":620,"wires":[["c13693aa.0e491"]]},{"id":"f12017d2.599888","type":"comment","z":"d47f9ae6.2bf798","name":"Esconder menús extra","info":"","x":220,"y":560,"wires":[]},{"id":"200959c7.8b6aa6","type":"ui_template","z":"d47f9ae6.2bf798","group":"5b045f76.22d7b","name":"HMTL Color Picker","order":2,"width":0,"height":0,"format":"<label for=\"colInterfaz\">Color Interfaz:</label>\n<input type=\"color\" ng-attr-size=\"100\" ng-model=\"msg.payload\" ng-change=\"send(msg)\" id=\"colInterfaz\"> ","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":210,"y":920,"wires":[["6fe84c49.7d6e34","1280214f.7d180f"]]},{"id":"3c610f95.9493d","type":"inject","z":"2ce33584.a2bf7a","name":"","topic":"","payload":"Hola! Soy Vapri","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":220,"y":500,"wires":[["3c80c4a9.5150ec"]]},{"id":"3c80c4a9.5150ec","type":"change","z":"2ce33584.a2bf7a","d":true,"name":"","rules":[{"t":"set","p":"emitVolume","pt":"msg","to":"50","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":500,"wires":[["cfba519e.e77b6"]]},{"id":"cfba519e.e77b6","type":"googlehome-notifier-offline","z":"2ce33584.a2bf7a","d":true,"server":"5ebdb320.8a967c","name":"","x":740,"y":500,"wires":[]},{"id":"b3e0f282.005b4","type":"comment","z":"2ce33584.a2bf7a","name":"Manda cadena de texto a Google Home","info":"","x":270,"y":460,"wires":[]},{"id":"6fb08028.6489f","type":"comment","z":"2ce33584.a2bf7a","name":"Configurar volumen","info":"","x":490,"y":540,"wires":[]},{"id":"b49a2ad1.dfd258","type":"link out","z":"2ce33584.a2bf7a","name":"fromChatInput","links":["e7927708.52abf8"],"x":555,"y":380,"wires":[]},{"id":"e7927708.52abf8","type":"link in","z":"2ce33584.a2bf7a","name":"toGoogleHome","links":["b49a2ad1.dfd258"],"x":355,"y":540,"wires":[["3c80c4a9.5150ec"]]},{"id":"7417cf1f.607d","type":"comment","z":"2ce33584.a2bf7a","name":"Chat entre Vapris","info":"","x":200,"y":100,"wires":[]},{"id":"a7487a9f.950e48","type":"comment","z":"2ce33584.a2bf7a","name":"From MQTT a Chat","info":"","x":210,"y":280,"wires":[]},{"id":"2c9b2576.b8837a","type":"switch","z":"2ce33584.a2bf7a","name":"Comandos Especiales","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"admin","vt":"str"},{"t":"eq","v":"noadmin","vt":"str"},{"t":"cont","v":"CMD: ","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":440,"y":160,"wires":[["5d33ccd6.e2af74"],["c179abe1.fe1878"],["70865c22.03f624"],["7ec3b2a8.d788ec"]]},{"id":"601f8350.77483c","type":"function","z":"d47f9ae6.2bf798","name":"Mostrar Tabs","func":"msg.payload = {\"tabs\": {\"show\": [\"Autónomo\", \"Sistema\"]}}\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":700,"wires":[["2f4db144.f0477e"]]},{"id":"824db6fc.484788","type":"link in","z":"d47f9ae6.2bf798","name":"toHideTabs","links":["c179abe1.fe1878"],"x":135,"y":660,"wires":[["c13693aa.0e491"]]},{"id":"634834fe.6efa7c","type":"link in","z":"d47f9ae6.2bf798","name":"toShowTabs","links":["5d33ccd6.e2af74"],"x":135,"y":700,"wires":[["601f8350.77483c"]]},{"id":"5d33ccd6.e2af74","type":"link out","z":"2ce33584.a2bf7a","name":"fromCommand\"admin\"","links":["634834fe.6efa7c"],"x":595,"y":140,"wires":[]},{"id":"c179abe1.fe1878","type":"link out","z":"2ce33584.a2bf7a","name":"fromCommand\"noadmin\"","links":["824db6fc.484788"],"x":655,"y":140,"wires":[]},{"id":"70865c22.03f624","type":"link out","z":"2ce33584.a2bf7a","name":"fromCommand\"CMD\"","links":["5481dbfc.29f1d4","c8dfd4c5.fba9d8"],"x":715,"y":140,"wires":[]},{"id":"c8dfd4c5.fba9d8","type":"link in","z":"c7c81a64.db1438","name":"toChatCMDExec","links":["70865c22.03f624"],"x":55,"y":740,"wires":[["7f82de2c.54b87"]]},{"id":"4afa199.02882e8","type":"comment","z":"c7c81a64.db1438","name":"Comandos desde el Vapri Chat","info":"","x":170,"y":640,"wires":[]},{"id":"b1f75cca.920b7","type":"exec","z":"c7c81a64.db1438","command":"","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":290,"y":740,"wires":[["6c54f474.e801dc"],["6c54f474.e801dc"],[]]},{"id":"dd8ac59c.c68998","type":"ui_slider","z":"d47f9ae6.2bf798","name":"","label":"Distancia Minima","tooltip":"","group":"6f7c3b98.411e14","order":2,"width":0,"height":0,"passthru":false,"outs":"end","topic":"","min":"0","max":"100","step":1,"x":1410,"y":460,"wires":[["cb3f9b31.a23cd8"]]},{"id":"cb3f9b31.a23cd8","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"distMin","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":460,"wires":[[]]},{"id":"f63323c1.16b8e","type":"link in","z":"d47f9ae6.2bf798","name":"distMin_End","links":["fae2078b.3f6498","b87b56a6.4a4dd8"],"x":1295,"y":460,"wires":[["dd8ac59c.c68998"]]},{"id":"2858010e.daed9e","type":"comment","z":"d47f9ae6.2bf798","name":"Modo Autónomo","info":"","x":1360,"y":40,"wires":[]},{"id":"958157ce.904d08","type":"comment","z":"d47f9ae6.2bf798","name":"Setup","info":"","x":1330,"y":360,"wires":[]},{"id":"af8bea66.0e6628","type":"link out","z":"28e94e1a.327fa2","name":"fromTelegramTimeout","links":["59afa785.3eff28"],"x":615,"y":240,"wires":[]},{"id":"c3d72a4c.ab5d88","type":"comment","z":"28e94e1a.327fa2","name":"Envía al Vapri Chat","info":"","x":970,"y":60,"wires":[]},{"id":"b8fa4394.4fe9b","type":"inject","z":"2acc8810.81c7a8","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":790,"y":140,"wires":[["2086c8ca.d44208"]]},{"id":"2086c8ca.d44208","type":"exec","z":"2acc8810.81c7a8","command":"awk '{print $1}' /proc/uptime","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":980,"y":140,"wires":[["b3f4b56c.5c7c48"],[],[]]},{"id":"eea4a8d6.a3ff98","type":"link out","z":"2acc8810.81c7a8","name":"fromUptimeReboot","links":["7ac78951.c26d78"],"x":1635,"y":140,"wires":[]},{"id":"149e0c56.d82444","type":"comment","z":"2acc8810.81c7a8","name":"Obtener tiempo encendido","info":"","x":830,"y":60,"wires":[]},{"id":"b3f4b56c.5c7c48","type":"change","z":"2acc8810.81c7a8","name":"~\\n~","rules":[{"t":"change","p":"payload","pt":"msg","from":"\\n","fromt":"re","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1170,"y":140,"wires":[["c7be09a7.c143b8"]]},{"id":"c7be09a7.c143b8","type":"function","z":"2acc8810.81c7a8","name":"to number","func":"msg.payload = Number(msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1300,"y":140,"wires":[["4e97fba1.6c6ec4"]]},{"id":"7f82de2c.54b87","type":"change","z":"c7c81a64.db1438","name":"~CMD:~","rules":[{"t":"change","p":"payload","pt":"msg","from":"CMD:","fromt":"str","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":740,"wires":[["b1f75cca.920b7"]]},{"id":"6c54f474.e801dc","type":"link out","z":"c7c81a64.db1438","name":"fromVapriChatExec","links":["ee02ea1a.bb19a8","b4b309ca.b73fc8"],"x":415,"y":740,"wires":[]},{"id":"b4b309ca.b73fc8","type":"link in","z":"2ce33584.a2bf7a","name":"toChatPropio","links":["6c54f474.e801dc"],"x":695,"y":380,"wires":[["19e5f05a.e6ba8"]]},{"id":"4e97fba1.6c6ec4","type":"switch","z":"2acc8810.81c7a8","name":"¿Resetear enlace Ngrok?","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"150","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":1490,"y":140,"wires":[["eea4a8d6.a3ff98"]]},{"id":"cc0fb3a0.b69cb","type":"comment","z":"8a7ddc8.106792","name":"Activa y desactiva enlaces de Ngrok en los puertos preseleccionados","info":"","x":340,"y":80,"wires":[]},{"id":"7ac78951.c26d78","type":"link in","z":"28e94e1a.327fa2","name":"toShutdownNgrok","links":["eea4a8d6.a3ff98"],"x":375,"y":200,"wires":[["f6833f94.68d51"]]},{"id":"58674656.4defe8","type":"telegrambot-command","z":"28e94e1a.327fa2","name":"/vapriKill","bot":"3ad0e292.3924ce","command":"/vapriKill","commandType":"str","commandCase":false,"x":120,"y":240,"wires":[["f6833f94.68d51"]]},{"id":"5c843bdb.214d74","type":"change","z":"28e94e1a.327fa2","name":"ui","rules":[{"t":"set","p":"topic","pt":"msg","to":"ui","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":140,"wires":[["7909f21a.35dbbc"]]},{"id":"c7198ae.0729f78","type":"comment","z":"28e94e1a.327fa2","name":"Envía a cualquier Chat que le haya escrito","info":"","x":1040,"y":220,"wires":[]},{"id":"41f15137.24ade","type":"comment","z":"28e94e1a.327fa2","name":"Comandos interceptados desde Telegram","info":"","x":220,"y":60,"wires":[]},{"id":"a98a5b0c.af62f8","type":"comment","z":"df558687.1df838","name":"Escaneo y decodificación de los QR para fijar objetivos u obtener poderes","info":"","x":360,"y":540,"wires":[]},{"id":"6e497871.0da3e8","type":"comment","z":"df558687.1df838","name":"Escanear el último fotograma","info":"","x":220,"y":260,"wires":[]},{"id":"ff14bd88.46663","type":"comment","z":"8a0a444f.751b78","name":"Animación Luz Inventoteca (deshabilitada)","info":"","x":2300,"y":580,"wires":[]},{"id":"b1ae2478.e6a108","type":"comment","z":"8a0a444f.751b78","name":"Poderes: Bolt","info":"","x":1390,"y":320,"wires":[]},{"id":"bcfbcad0.4ccd28","type":"ui_form","z":"d47f9ae6.2bf798","name":"","label":"WiFi","group":"504d9cda.7d0854","order":1,"width":0,"height":0,"options":[{"label":"Red","value":"ssid","type":"text","required":true,"rows":null},{"label":"Contraseña","value":"pass","type":"password","required":true,"rows":null}],"formValue":{"ssid":"","pass":""},"payload":"","submit":"Conectar","cancel":"Cancel","topic":"","x":910,"y":460,"wires":[["7949855e.5454ac"]]},{"id":"e6b0aa02.10afe8","type":"debug","z":"c7c81a64.db1438","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1695,"y":116,"wires":[]},{"id":"653a12c5.159f1c","type":"function","z":"c7c81a64.db1438","name":"Formato wpa_supplicant","func":"var ssid = msg.payload.ssid;\nvar psk = msg.payload.pass;\n\n\nvar formato = 'ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev' \nformato += '\\n';\nformato += 'update_config=1'\nformato += '\\n';\nformato += 'country=MX'\nformato += '\\n';\n\nformato += 'network={'\nformato += '\\n\\t';\nformato += 'ssid=\"'\nformato += ssid;\nformato += '\"\\n\\t';\nformato += 'psk=\"';\nformato += psk\nformato += '\"\\n\\t';\nformato += 'id_str=\"AP1\"'\nformato += '\\n\\t';\nformato += \"}\";\n\nmsg = {payload:formato};\nreturn msg;","outputs":1,"noerr":0,"x":875,"y":116,"wires":[["7892a413.68d79c"]]},{"id":"2b3da274.fd5e2e","type":"exec","z":"c7c81a64.db1438","command":"sudo service networking restart","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":1475,"y":116,"wires":[["e6b0aa02.10afe8"],[],[]]},{"id":"5bf219a3.0eafa8","type":"comment","z":"c7c81a64.db1438","name":"Cambiar nombre de AP","info":"","x":800,"y":180,"wires":[]},{"id":"c3287e77.6fc21","type":"ui_text_input","z":"d47f9ae6.2bf798","name":"","label":"Nombre del Vapri","tooltip":"","group":"5b045f76.22d7b","order":1,"width":0,"height":0,"passthru":false,"mode":"text","delay":"0","topic":"","x":490,"y":1060,"wires":[["fb952c45.a8469"]]},{"id":"f17f6f9a.72fec","type":"link out","z":"d47f9ae6.2bf798","name":"dashboard-vapriName","links":["cf9d6b1.e63e798"],"x":635,"y":1000,"wires":[]},{"id":"7cbe5cb6.587844","type":"comment","z":"c7c81a64.db1438","name":"Cambiar nombre de la Camara","info":"","x":830,"y":300,"wires":[]},{"id":"cf9d6b1.e63e798","type":"link in","z":"c7c81a64.db1438","name":"exec-vapriName","links":["f17f6f9a.72fec"],"x":715,"y":360,"wires":[["460e5d21.311234"]]},{"id":"cf0b3a46.dc9328","type":"exec","z":"c7c81a64.db1438","command":"","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"cambio en camara","x":1190,"y":360,"wires":[["c53d8a3b.1cd578"],[],[]]},{"id":"460e5d21.311234","type":"function","z":"c7c81a64.db1438","name":"Formato cambio de nombre en camara","func":"var nombre = msg.payload;\n\nmsg.payload = 'echo ';\nmsg.payload += \"'an \";\nmsg.payload += nombre;\nmsg.payload += \" %Y.%M.%D_%h:%m:%s' >/var/www/FIFO\"\n\n\n\nreturn msg;","outputs":1,"noerr":0,"x":910,"y":360,"wires":[["cf0b3a46.dc9328"]]},{"id":"c53d8a3b.1cd578","type":"debug","z":"c7c81a64.db1438","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1390,"y":360,"wires":[]},{"id":"38a11874.6e7008","type":"ui_text_input","z":"d47f9ae6.2bf798","name":"","label":"BotToken","tooltip":"","group":"5b045f76.22d7b","order":2,"width":0,"height":0,"passthru":false,"mode":"password","delay":"0","topic":"Nuevo Token","x":320,"y":1160,"wires":[["ca2e58b5.279828"]]},{"id":"4a669dac.7644c4","type":"link out","z":"d47f9ae6.2bf798","name":"dasboard-btoken","links":["8c825c8b.a51dc"],"x":815,"y":1160,"wires":[]},{"id":"8b48cef7.73baa","type":"function","z":"c7c81a64.db1438","name":"formato para botToken","func":"var token = msg.token;\n\nmsg.payload = 'sed -i \"s/^process.env.BotToken =.*/process.env.BotToken =';\nmsg.payload += \"'\";\nmsg.payload += token;\nmsg.payload += \"'\";\nmsg.payload += ';/\"';\nmsg.payload +=  ' .node-red/settings.js';\nreturn msg;","outputs":1,"noerr":0,"x":900,"y":500,"wires":[["f61cbbe6.7e5b38"]]},{"id":"1d701622.9b852a","type":"debug","z":"c7c81a64.db1438","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1390,"y":580,"wires":[]},{"id":"1487d906.6a0db7","type":"comment","z":"c7c81a64.db1438","name":"Cambiar BotToken","info":"","x":790,"y":420,"wires":[]},{"id":"8c825c8b.a51dc","type":"link in","z":"c7c81a64.db1438","name":"exec-btoken","links":["4a669dac.7644c4"],"x":715,"y":500,"wires":[["8b48cef7.73baa"]]},{"id":"f61cbbe6.7e5b38","type":"exec","z":"c7c81a64.db1438","command":"","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"cambiar botToken","x":1170,"y":500,"wires":[["1d701622.9b852a","577c549b.277dfc"],["1d701622.9b852a"],["1d701622.9b852a"]]},{"id":"577c549b.277dfc","type":"exec","z":"c7c81a64.db1438","command":"node-red-restart","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"reiniciar node-RED","x":1410,"y":500,"wires":[["1d701622.9b852a"],["1d701622.9b852a"],["1d701622.9b852a"]]},{"id":"bf7733ad.adc4d","type":"inject","z":"d47f9ae6.2bf798","name":"","topic":"","payload":"vapriName","payloadType":"global","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":230,"y":1060,"wires":[["c3287e77.6fc21"]]},{"id":"774e72e0.0c53bc","type":"inject","z":"d47f9ae6.2bf798","name":"token","topic":"","payload":"BotToken","payloadType":"env","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":190,"y":1160,"wires":[["38a11874.6e7008"]]},{"id":"6c848460.9f47dc","type":"ui_toast","z":"d47f9ae6.2bf798","position":"dialog","displayTime":"3","highlight":"","sendall":true,"outputs":1,"ok":"Cambiar Token","cancel":"Cancelar","raw":true,"topic":"Nuevo Token","name":"","x":650,"y":1160,"wires":[["3f32c6e8.a375fa","4a669dac.7644c4"]]},{"id":"3f32c6e8.a375fa","type":"debug","z":"d47f9ae6.2bf798","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":740,"y":1080,"wires":[]},{"id":"ca2e58b5.279828","type":"change","z":"d47f9ae6.2bf798","name":"","rules":[{"t":"set","p":"token","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"Se reiniciará la interfaz","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":1160,"wires":[["6c848460.9f47dc"]]},{"id":"b3bfb864.7f2958","type":"exec","z":"2acc8810.81c7a8","command":"iwgetid","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":580,"y":180,"wires":[["65c0ea22.98d804"],[],[]]},{"id":"1682f7fd.5a4de8","type":"debug","z":"2acc8810.81c7a8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1210,"y":280,"wires":[]},{"id":"65c0ea22.98d804","type":"split","z":"2acc8810.81c7a8","name":"","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":720,"y":240,"wires":[["ca4b07a3.9ae138"]]},{"id":"ca4b07a3.9ae138","type":"switch","z":"2acc8810.81c7a8","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"ESSID","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":240,"wires":[[],["74d99e55.7c0f8"]]},{"id":"74d99e55.7c0f8","type":"function","z":"2acc8810.81c7a8","name":"Quitar comillas","func":"var cadena = msg.payload;\ncadena = cadena.replace(/['\"]+/g, '');\nmsg.payload = {\"ssid\":cadena}\nreturn msg;","outputs":1,"noerr":0,"x":1020,"y":240,"wires":[["cebb0268.fd78c","1682f7fd.5a4de8"]]}]